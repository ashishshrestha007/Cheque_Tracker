<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deposit | ChequeTracker</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary: #0052CC;
            --primary-hover: #0065FF;
            --primary-light: rgba(0, 82, 204, 0.08);
            --accent: #0065FF;
            --accent-hover: #2684FF;
            --accent-light: rgba(0, 101, 255, 0.1);
            --text-primary: #172B4D;
            --text-secondary: #5E6C84;
            --text-muted: #97A0AF;
            --bg-primary: #FFFFFF;
            --bg-secondary: #F4F5F7;
            --bg-tertiary: #EBECF0;
            --border: #DFE1E6;
            --border-focus: #0052CC;
            --success: #00875A;
            --success-light: rgba(0, 135, 90, 0.1);
            --error: #DE350B;
            --error-light: rgba(222, 53, 11, 0.1);
            --warning: #FF991F;
            --warning-light: rgba(255, 153, 31, 0.1);
            --info: #0065FF;
            --info-light: rgba(0, 101, 255, 0.1);
            --shadow-sm: 0 1px 2px rgba(9, 30, 66, 0.08);
            --shadow-md: 0 4px 8px rgba(9, 30, 66, 0.1);
            --shadow-lg: 0 8px 16px rgba(9, 30, 66, 0.12);
            --shadow-xl: 0 16px 32px rgba(9, 30, 66, 0.15);
            --radius-sm: 4px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --radius-xl: 16px;
            --transition: all 0.2s ease;
            --transition-slow: all 0.3s ease;
            --header-bg: linear-gradient(135deg, #0052CC 0%, #0747A6 100%);
            --sidebar-width: 260px;
        }

        [data-theme="dark"] {
            --primary: #4C9AFF;
            --primary-hover: #79B8FF;
            --primary-light: rgba(76, 154, 255, 0.12);
            --accent: #4C9AFF;
            --accent-hover: #79B8FF;
            --accent-light: rgba(76, 154, 255, 0.12);
            --text-primary: #E6E8EB;
            --text-secondary: #B8C1CC;
            --text-muted: #8C95A0;
            --bg-primary: #161B22;
            --bg-secondary: #0D1117;
            --bg-tertiary: #21262D;
            --border: #30363D;
            --border-focus: #4C9AFF;
            --success-light: rgba(0, 135, 90, 0.2);
            --error-light: rgba(222, 53, 11, 0.2);
            --warning-light: rgba(255, 153, 31, 0.2);
            --info-light: rgba(0, 101, 255, 0.2);
            --header-bg: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            height: 100%;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-secondary);
            min-height: 100vh;
            color: var(--text-primary);
            transition: var(--transition);
            -webkit-font-smoothing: antialiased;
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            bottom: 0;
            width: var(--sidebar-width);
            background: var(--header-bg);
            padding: 24px 0;
            z-index: 100;
            overflow: hidden;
        }

        .sidebar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: radial-gradient(rgba(255,255,255,0.03) 1px, transparent 1px);
            background-size: 20px 20px;
            pointer-events: none;
        }

        .sidebar-shapes {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            overflow: hidden;
            pointer-events: none;
        }

        .sidebar-circle {
            position: absolute;
            border-radius: 50%;
            background: linear-gradient(135deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.02) 100%);
            border: 1px solid rgba(255,255,255,0.05);
        }

        .sidebar-circle-1 { width: 150px; height: 150px; top: -50px; right: -50px; animation: float1 20s ease-in-out infinite; }
        .sidebar-circle-2 { width: 100px; height: 100px; bottom: 20%; left: -30px; animation: float2 25s ease-in-out infinite; }
        .sidebar-circle-3 { width: 80px; height: 80px; bottom: -20px; right: 20px; animation: float3 18s ease-in-out infinite; }

        @keyframes float1 { 0%, 100% { transform: translate(0, 0); } 50% { transform: translate(-10px, 20px); } }
        @keyframes float2 { 0%, 100% { transform: translate(0, 0); } 50% { transform: translate(20px, -15px); } }
        @keyframes float3 { 0%, 100% { transform: translate(0, 0); } 50% { transform: translate(-15px, -10px); } }

        .sidebar-logo {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 0 24px;
            margin-bottom: 32px;
            position: relative;
            z-index: 1;
        }

        .sidebar-logo .logo-icon {
            width: 42px;
            height: 42px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .sidebar-logo .logo-icon svg {
            width: 22px;
            height: 22px;
            fill: white;
        }

        .sidebar-logo .logo-text {
            display: flex;
            flex-direction: column;
        }

        .sidebar-logo .logo-text span:first-child {
            font-size: 18px;
            font-weight: 700;
            color: white;
            letter-spacing: -0.3px;
        }

        .sidebar-logo .logo-text span:last-child {
            font-size: 10px;
            color: rgba(255, 255, 255, 0.6);
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .sidebar-nav {
            padding: 0 12px;
            position: relative;
            z-index: 1;
        }

        .nav-section {
            margin-bottom: 24px;
        }

        .nav-section-title {
            font-size: 10px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.4);
            text-transform: uppercase;
            letter-spacing: 1.5px;
            padding: 0 12px;
            margin-bottom: 8px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            border-radius: var(--radius-md);
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            transition: var(--transition);
            margin-bottom: 4px;
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .nav-item.active {
            background: rgba(255, 255, 255, 0.15);
            color: white;
        }

        .nav-item svg {
            width: 20px;
            height: 20px;
            fill: currentColor;
            flex-shrink: 0;
        }

        .nav-item .badge {
            margin-left: auto;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 11px;
            font-weight: 600;
            padding: 2px 8px;
            border-radius: 10px;
        }

        .nav-item .badge.alert {
            background: var(--error);
        }

        .sidebar-footer {
            position: absolute;
            bottom: 24px;
            left: 12px;
            right: 12px;
            z-index: 1;
        }

        .sidebar-user {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-lg);
            margin-bottom: 12px;
        }

        .sidebar-user-avatar {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #4C9AFF 0%, #00C7E6 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .sidebar-user-avatar svg {
            width: 20px;
            height: 20px;
            fill: white;
        }

        .sidebar-user-info {
            flex: 1;
            min-width: 0;
        }

        .sidebar-user-name {
            font-size: 13px;
            font-weight: 600;
            color: white;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .sidebar-user-role {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.6);
        }

        .logout-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-md);
            color: rgba(255, 255, 255, 0.8);
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
        }

        .logout-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            color: white;
        }

        .logout-btn svg {
            width: 18px;
            height: 18px;
            fill: currentColor;
        }

        /* Main Content */
        .main-wrapper {
            margin-left: var(--sidebar-width);
            min-height: 100vh;
        }

        /* Header */
        .header {
            background: var(--bg-primary);
            border-bottom: 1px solid var(--border);
            padding: 16px 32px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 50;
        }

        .header-left {
            display: flex;
            flex-direction: column;
        }

        .header-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-primary);
            letter-spacing: -0.5px;
        }

        .header-subtitle {
            font-size: 13px;
            color: var(--text-secondary);
            margin-top: 2px;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .header-datetime {
            text-align: right;
            padding-right: 16px;
            border-right: 1px solid var(--border);
        }

        .header-time {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .header-date {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .header-btn {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-md);
            border: 1px solid var(--border);
            background: var(--bg-primary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            position: relative;
        }

        .header-btn:hover {
            background: var(--bg-secondary);
            border-color: var(--text-muted);
        }

        .header-btn svg {
            width: 20px;
            height: 20px;
            fill: var(--text-secondary);
        }

        .header-btn .badge {
            position: absolute;
            top: -4px;
            right: -4px;
            min-width: 18px;
            height: 18px;
            background: var(--error);
            color: white;
            font-size: 10px;
            font-weight: 700;
            border-radius: 9px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 4px;
        }

        .header-btn .badge:empty,
        .header-btn .badge[data-count="0"] {
            display: none;
        }

        .theme-toggle .sun { display: none; }
        [data-theme="dark"] .theme-toggle .sun { display: block; }
        [data-theme="dark"] .theme-toggle .moon { display: none; }

        /* Notification Dropdown */
        .notification-wrapper {
            position: relative;
        }

        .notification-dropdown {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            width: 380px;
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-xl);
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: var(--transition);
            z-index: 1000;
            overflow: hidden;
        }

        .notification-dropdown.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .notification-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 20px;
            border-bottom: 1px solid var(--border);
            background: var(--bg-secondary);
        }

        .notification-header h4 {
            font-size: 14px;
            font-weight: 700;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .notification-header h4 .count {
            background: var(--error);
            color: white;
            font-size: 10px;
            font-weight: 700;
            padding: 2px 6px;
            border-radius: 10px;
        }

        .notification-header-actions {
            display: flex;
            gap: 8px;
        }

        .notification-header-btn {
            padding: 6px 12px;
            background: transparent;
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            font-size: 11px;
            font-weight: 600;
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition);
        }

        .notification-header-btn:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .notification-header-btn.danger:hover {
            background: var(--error-light);
            color: var(--error);
            border-color: var(--error);
        }

        .notification-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .notification-item {
            display: flex;
            gap: 12px;
            padding: 14px 20px;
            border-bottom: 1px solid var(--border);
            cursor: pointer;
            transition: var(--transition);
        }

        .notification-item:hover {
            background: var(--bg-secondary);
        }

        .notification-item.unread {
            background: var(--primary-light);
            border-left: 3px solid var(--primary);
        }

        .notification-item.unread:hover {
            background: rgba(0, 82, 204, 0.12);
        }

        .notification-item:last-child {
            border-bottom: none;
        }

        .notification-icon {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .notification-icon svg {
            width: 20px;
            height: 20px;
            fill: white;
        }

        .notification-icon.success { background: linear-gradient(135deg, #00875A, #006644); }
        .notification-icon.warning { background: linear-gradient(135deg, #FF991F, #FF8B00); }
        .notification-icon.info { background: linear-gradient(135deg, #0052CC, #0747A6); }
        .notification-icon.error { background: linear-gradient(135deg, #DE350B, #BF2600); }

        .notification-content {
            flex: 1;
            min-width: 0;
        }

        .notification-title {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .notification-message {
            font-size: 12px;
            color: var(--text-muted);
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .notification-time {
            font-size: 10px;
            color: var(--text-muted);
            margin-top: 6px;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .notification-time svg {
            width: 12px;
            height: 12px;
            fill: var(--text-muted);
        }

        .notification-empty {
            padding: 40px 20px;
            text-align: center;
        }

        .notification-empty-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--bg-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 16px;
        }

        .notification-empty-icon svg {
            width: 30px;
            height: 30px;
            fill: var(--text-muted);
        }

        .notification-empty h5 {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .notification-empty p {
            font-size: 12px;
            color: var(--text-muted);
        }

        .notification-footer {
            padding: 12px 20px;
            border-top: 1px solid var(--border);
            text-align: center;
        }

        .notification-footer a {
            font-size: 12px;
            font-weight: 600;
            color: var(--primary);
            text-decoration: none;
            transition: var(--transition);
        }

        .notification-footer a:hover {
            text-decoration: underline;
        }

        /* Main Content Area */
        .main-content {
            padding: 24px 32px;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Quick Stats */
        .quick-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }

        .quick-stat-card {
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 16px;
            transition: var(--transition);
        }

        .quick-stat-card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .quick-stat-icon {
            width: 48px;
            height: 48px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .quick-stat-icon svg {
            width: 24px;
            height: 24px;
            fill: white;
        }

        .quick-stat-icon.blue { background: linear-gradient(135deg, #0052CC, #0747A6); }
        .quick-stat-icon.green { background: linear-gradient(135deg, #00875A, #006644); }
        .quick-stat-icon.orange { background: linear-gradient(135deg, #FF991F, #FF8B00); }
        .quick-stat-icon.purple { background: linear-gradient(135deg, #6554C0, #5243AA); }

        .quick-stat-content h4 {
            font-size: 22px;
            font-weight: 800;
            color: var(--text-primary);
        }

        .quick-stat-content p {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 2px;
        }

        /* Step Indicator */
        .step-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0;
            margin-bottom: 32px;
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: var(--radius-xl);
            padding: 24px 40px;
        }

        .step {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--bg-tertiary);
            border: 2px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            font-weight: 700;
            color: var(--text-muted);
            transition: var(--transition);
        }

        .step.active .step-number {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
        }

        .step.completed .step-number {
            background: var(--success);
            border-color: var(--success);
            color: white;
        }

        .step-info {
            display: flex;
            flex-direction: column;
        }

        .step-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-muted);
            transition: var(--transition);
        }

        .step.active .step-title,
        .step.completed .step-title {
            color: var(--text-primary);
        }

        .step-subtitle {
            font-size: 12px;
            color: var(--text-muted);
        }

        .step-connector {
            width: 80px;
            height: 2px;
            background: var(--border);
            margin: 0 20px;
        }

        .step-connector.active {
            background: var(--primary);
        }

        /* Content Layout */
        .content-layout {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 24px;
        }

        /* Pending Cheques Section */
        .pending-cheques-section {
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: var(--radius-xl);
            overflow: hidden;
        }

        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px 24px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
        }

        .section-header-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .section-header-icon {
            width: 44px;
            height: 44px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .section-header-icon svg {
            width: 22px;
            height: 22px;
            fill: white;
        }

        .section-header-icon.blue { background: linear-gradient(135deg, #0052CC, #0747A6); }
        .section-header-icon.green { background: linear-gradient(135deg, #00875A, #006644); }
        .section-header-icon.orange { background: linear-gradient(135deg, #FF991F, #FF8B00); }

        .section-header h3 {
            font-size: 16px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .section-header p {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 2px;
        }

        .section-header-right {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .select-all-wrapper {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: var(--transition);
        }

        .select-all-wrapper:hover {
            border-color: var(--primary);
        }

        .select-all-wrapper input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: var(--primary);
        }

        .select-all-wrapper label {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-primary);
            cursor: pointer;
        }

        /* Cheque List */
        .cheque-list {
            max-height: 500px;
            overflow-y: auto;
        }

        .cheque-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 16px 24px;
            border-bottom: 1px solid var(--border);
            transition: var(--transition);
            cursor: pointer;
        }

        .cheque-item:hover {
            background: var(--bg-secondary);
        }

        .cheque-item.selected {
            background: var(--primary-light);
            border-left: 3px solid var(--primary);
        }

        .cheque-item:last-child {
            border-bottom: none;
        }

        .cheque-checkbox {
            width: 22px;
            height: 22px;
            cursor: pointer;
            accent-color: var(--primary);
            flex-shrink: 0;
        }

        .cheque-info {
            flex: 1;
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 120px;
            gap: 16px;
            align-items: center;
        }

        .cheque-detail {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .cheque-detail-label {
            font-size: 10px;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .cheque-detail-value {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .cheque-detail-value.highlight {
            color: var(--primary);
        }

        .cheque-detail-value.amount {
            color: var(--success);
            font-size: 14px;
            font-weight: 700;
        }

        .cheque-status {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
        }

        .cheque-status.pending {
            background: var(--warning-light);
            color: var(--warning);
        }

        .cheque-status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: currentColor;
        }

        .empty-state {
            padding: 60px 24px;
            text-align: center;
        }

        .empty-state-icon {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: var(--bg-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
        }

        .empty-state-icon svg {
            width: 40px;
            height: 40px;
            fill: var(--text-muted);
        }

        .empty-state h4 {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .empty-state p {
            font-size: 13px;
            color: var(--text-muted);
            margin-bottom: 20px;
        }

        /* Deposit Form Section */
        .deposit-form-section {
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: var(--radius-xl);
            overflow: hidden;
            position: sticky;
            top: 100px;
        }

        .deposit-form-header {
            background: linear-gradient(135deg, #00875A 0%, #006644 100%);
            padding: 20px 24px;
        }

        .deposit-form-header h3 {
            font-size: 16px;
            font-weight: 700;
            color: white;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .deposit-form-header h3 svg {
            width: 20px;
            height: 20px;
            fill: white;
        }

        .deposit-form-header p {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
            margin-top: 4px;
        }

        /* Selected Summary */
        .selected-summary {
            padding: 20px 24px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
        }

        .selected-summary-title {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 12px;
        }

        .selected-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .selected-stat {
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            padding: 12px;
            text-align: center;
        }

        .selected-stat-value {
            font-size: 20px;
            font-weight: 800;
            color: var(--primary);
        }

        .selected-stat-value.amount {
            color: var(--success);
            font-size: 16px;
        }

        .selected-stat-label {
            font-size: 11px;
            color: var(--text-muted);
            margin-top: 4px;
        }

        /* Deposit Form */
        .deposit-form {
            padding: 24px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group:last-child {
            margin-bottom: 0;
        }

        .form-label {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .form-label .required {
            color: var(--error);
            font-weight: 700;
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            height: 48px;
            padding: 0 16px;
            background: var(--bg-primary);
            border: 2px solid var(--border);
            border-radius: var(--radius-md);
            font-family: inherit;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
            transition: var(--transition);
            outline: none;
        }

        .form-textarea {
            height: auto;
            min-height: 80px;
            padding: 12px 16px;
            resize: vertical;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 4px var(--primary-light);
        }

        .form-select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%2397A0AF'%3E%3Cpath d='M7 10l5 5 5-5z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 24px;
            padding-right: 44px;
            cursor: pointer;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            height: 48px;
            padding: 0 24px;
            border-radius: var(--radius-md);
            font-family: inherit;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            border: 2px solid transparent;
            text-decoration: none;
        }

        .btn svg {
            width: 18px;
            height: 18px;
            fill: currentColor;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-hover);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 82, 204, 0.4);
        }

        .btn-secondary {
            background: var(--bg-primary);
            border-color: var(--border);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background: var(--bg-secondary);
            border-color: var(--text-muted);
        }

        .btn-success {
            background: linear-gradient(135deg, #00875A 0%, #006644 100%);
            color: white;
            width: 100%;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 135, 90, 0.4);
        }

        .btn-success:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn-excel {
            background: linear-gradient(135deg, #217346 0%, #185C37 100%);
            color: white;
        }

        .btn-excel:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(33, 115, 70, 0.4);
        }

        .form-actions {
            margin-top: 24px;
        }

        /* Deposit History Section */
        .deposit-history-section {
            margin-top: 24px;
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: var(--radius-xl);
            overflow: hidden;
        }

        .table-wrapper {
            overflow-x: auto;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th,
        .data-table td {
            padding: 14px 20px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        .data-table th {
            background: var(--bg-secondary);
            font-size: 11px;
            font-weight: 700;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .data-table td {
            font-size: 13px;
            color: var(--text-primary);
        }

        .data-table tbody tr:hover {
            background: var(--bg-secondary);
        }

        .data-table tbody tr:last-child td {
            border-bottom: none;
        }

        .deposit-id {
            font-weight: 700;
            color: var(--primary);
        }

        .deposit-amount {
            font-weight: 700;
            color: var(--success);
        }

        .deposit-cheques-count {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            background: var(--primary-light);
            color: var(--primary);
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .table-status {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
        }

        .table-status.processing {
            background: var(--info-light);
            color: var(--info);
        }

        .table-status.completed {
            background: var(--success-light);
            color: var(--success);
        }

        .table-actions {
            display: flex;
            gap: 8px;
        }

        .table-action-btn {
            width: 32px;
            height: 32px;
            border-radius: var(--radius-sm);
            border: 1px solid var(--border);
            background: var(--bg-primary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .table-action-btn:hover {
            background: var(--bg-secondary);
            border-color: var(--text-muted);
        }

        .table-action-btn svg {
            width: 16px;
            height: 16px;
            fill: var(--text-muted);
        }

        .table-action-btn:hover svg {
            fill: var(--text-primary);
        }

        .table-action-btn.view:hover {
            border-color: var(--primary);
            background: var(--primary-light);
        }

        .table-action-btn.view:hover svg {
            fill: var(--primary);
        }

        /* Footer */
        .footer {
            padding: 20px 32px;
            border-top: 1px solid var(--border);
            text-align: center;
        }

        .footer p {
            font-size: 12px;
            color: var(--text-muted);
        }

        /* Toast Notification */
        .toast-container {
            position: fixed;
            top: 24px;
            right: 24px;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .toast {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 16px 20px;
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-xl);
            min-width: 380px;
            max-width: 450px;
            animation: slideInRight 0.3s ease-out;
        }

        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(100px); }
            to { opacity: 1; transform: translateX(0); }
        }

        @keyframes slideOutRight {
            from { opacity: 1; transform: translateX(0); }
            to { opacity: 0; transform: translateX(100px); }
        }

        .toast.success {
            border-left: 4px solid var(--success);
        }

        .toast.error {
            border-left: 4px solid var(--error);
        }

        .toast.warning {
            border-left: 4px solid var(--warning);
        }

        .toast-icon {
            width: 44px;
            height: 44px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .toast-icon svg {
            width: 22px;
            height: 22px;
            fill: white;
        }

        .toast.success .toast-icon {
            background: linear-gradient(135deg, #00875A, #006644);
        }

        .toast.error .toast-icon {
            background: linear-gradient(135deg, #DE350B, #BF2600);
        }

        .toast.warning .toast-icon {
            background: linear-gradient(135deg, #FF991F, #FF8B00);
        }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .toast-message {
            font-size: 12px;
            color: var(--text-muted);
            line-height: 1.5;
        }

        .toast-close {
            width: 28px;
            height: 28px;
            border-radius: var(--radius-sm);
            border: none;
            background: transparent;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            flex-shrink: 0;
        }

        .toast-close:hover {
            background: var(--bg-secondary);
        }

        .toast-close svg {
            width: 16px;
            height: 16px;
            fill: var(--text-muted);
        }

        /* View Deposit Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: var(--bg-primary);
            border-radius: var(--radius-xl);
            max-width: 700px;
            width: 90%;
            max-height: 85vh;
            overflow: hidden;
            transform: scale(0.9);
            transition: var(--transition);
        }

        .modal-overlay.active .modal {
            transform: scale(1);
        }

        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px 24px;
            background: linear-gradient(135deg, #00875A 0%, #006644 100%);
        }

        .modal-header h3 {
            font-size: 18px;
            font-weight: 700;
            color: white;
        }

        .modal-close {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-md);
            border: none;
            background: rgba(255, 255, 255, 0.2);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .modal-close svg {
            width: 20px;
            height: 20px;
            fill: white;
        }

        .modal-body {
            padding: 24px;
            max-height: calc(85vh - 130px);
            overflow-y: auto;
        }

        .modal-section {
            margin-bottom: 24px;
        }

        .modal-section:last-child {
            margin-bottom: 0;
        }

        .modal-section-title {
            font-size: 12px;
            font-weight: 700;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--border);
        }

        .modal-info-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
        }

        .modal-info-item {
            background: var(--bg-secondary);
            padding: 12px 16px;
            border-radius: var(--radius-md);
        }

        .modal-info-label {
            font-size: 11px;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .modal-info-value {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-top: 4px;
        }

        .modal-info-value.highlight {
            color: var(--primary);
        }

        .modal-info-value.amount {
            color: var(--success);
            font-size: 18px;
            font-weight: 700;
        }

        .modal-cheques-list {
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            overflow: hidden;
        }

        .modal-cheque-item {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 100px;
            gap: 12px;
            padding: 12px 16px;
            border-bottom: 1px solid var(--border);
            font-size: 13px;
        }

        .modal-cheque-item:last-child {
            border-bottom: none;
        }

        .modal-cheque-item.header {
            background: var(--bg-secondary);
            font-size: 11px;
            font-weight: 700;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .content-layout {
                grid-template-columns: 1fr;
            }

            .deposit-form-section {
                position: static;
            }

            .quick-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .cheque-info {
                grid-template-columns: 1fr 1fr;
                gap: 12px;
            }
        }

        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .main-wrapper {
                margin-left: 0;
            }
        }

        @media (max-width: 768px) {
            .header {
                padding: 12px 16px;
            }

            .header-datetime {
                display: none;
            }

            .main-content {
                padding: 16px;
            }

            .quick-stats {
                grid-template-columns: 1fr;
            }

            .step-indicator {
                flex-direction: column;
                gap: 16px;
            }

            .step-connector {
                width: 2px;
                height: 30px;
                margin: 0;
            }

            .cheque-info {
                grid-template-columns: 1fr;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .modal-info-grid {
                grid-template-columns: 1fr;
            }

            .modal-cheque-item {
                grid-template-columns: 1fr 1fr;
            }

            .notification-dropdown {
                width: 320px;
                right: -60px;
            }
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-shapes">
            <div class="sidebar-circle sidebar-circle-1"></div>
            <div class="sidebar-circle sidebar-circle-2"></div>
            <div class="sidebar-circle sidebar-circle-3"></div>
        </div>

        <div class="sidebar-logo">
            <div class="logo-icon">
                <svg viewBox="0 0 24 24">
                    <path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/>
                </svg>
            </div>
            <div class="logo-text">
                <span>ChequeTracker</span>
                <span>Management</span>
            </div>
        </div>

        <nav class="sidebar-nav">
            <div class="nav-section">
                <div class="nav-section-title">Main Menu</div>
                <a href="{% url 'dashboard' %}" class="nav-item">
                    <svg viewBox="0 0 24 24"><path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/></svg>
                    Dashboard
                </a>
                <a href="{% url 'cheque' %}" class="nav-item">
                    <svg viewBox="0 0 24 24"><path d="M19 14V6c0-1.1-.9-2-2-2H3c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zm-9-1c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm13-6v11c0 1.1-.9 2-2 2H4v-2h17V7h2z"/></svg>
                    Cheque In
                    <span class="badge alert" id="pendingBadge">0</span>
                </a>
                <a href="{% url 'deposit' %}" class="nav-item active">
                    <svg viewBox="0 0 24 24"><path d="M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4z"/></svg>
                    Deposit
                </a>
                <a href="{% url 'report' %}" class="nav-item">
                    <svg viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/></svg>
                    Reports
                </a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Settings</div>
                <a href="{% url 'setting' %}" class="nav-item">
                    <svg viewBox="0 0 24 24"><path d="M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg>
                    Settings
                </a>
                <a href="{% url 'help' %}" class="nav-item">
                    <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>
                    Help & Support
                </a>
            </div>
        </nav>

        <div class="sidebar-footer">
            <div class="sidebar-user">
                <div class="sidebar-user-avatar">
                    <svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
                </div>
                <div class="sidebar-user-info">
                    <div class="sidebar-user-name">John Doe</div>
                    <div class="sidebar-user-role">Administrator</div>
                </div>
            </div>
            <a href="login.html" class="logout-btn">
                <svg viewBox="0 0 24 24"><path d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"/></svg>
                Sign Out
            </a>
        </div>
    </aside>

    <!-- Main Wrapper -->
    <div class="main-wrapper">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <h1 class="header-title">Deposit Cheques</h1>
                <p class="header-subtitle">Select deposited cheques and record deposit details</p>
            </div>
            <div class="header-right">
                <div class="header-datetime">
                    <div class="header-time" id="currentTime">00:00</div>
                    <div class="header-date" id="currentDate">Loading...</div>
                </div>
                <div class="header-actions">
                    <!-- Notification Button with Dropdown -->
                    <div class="notification-wrapper">
                        <button class="header-btn" id="notificationBtn" title="Notifications" onclick="toggleNotificationDropdown()">
                            <svg viewBox="0 0 24 24"><path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"/></svg>
                            <span class="badge" id="notificationBadge">0</span>
                        </button>
                        
                        <!-- Notification Dropdown -->
                        <div class="notification-dropdown" id="notificationDropdown">
                            <div class="notification-header">
                                <h4>
                                    Notifications
                                    <span class="count" id="notificationCount">0</span>
                                </h4>
                                <div class="notification-header-actions">
                                    <button class="notification-header-btn" onclick="markAllAsRead()">Mark all read</button>
                                    <button class="notification-header-btn danger" onclick="clearAllNotifications()">Clear all</button>
                                </div>
                            </div>
                            <div class="notification-list" id="notificationList">
                                <!-- Notifications will be loaded here -->
                            </div>
                            <div class="notification-footer">
                                <a href="#" onclick="viewAllNotifications()">View all notifications</a>
                            </div>
                        </div>
                    </div>

                    <button class="header-btn theme-toggle" onclick="toggleTheme()" title="Toggle Theme">
                        <svg class="moon" viewBox="0 0 24 24"><path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"/></svg>
                        <svg class="sun" viewBox="0 0 24 24"><path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0 .39-.39.39-1.03 0-1.41l-1.06-1.06zm1.06-10.96c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"/></svg>
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Quick Stats -->
            <div class="quick-stats">
                <div class="quick-stat-card">
                    <div class="quick-stat-icon orange">
                        <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>
                    </div>
                    <div class="quick-stat-content">
                        <h4 id="statPending">0</h4>
                        <p>Pending Cheques</p>
                    </div>
                </div>
                <div class="quick-stat-card">
                    <div class="quick-stat-icon blue">
                        <svg viewBox="0 0 24 24"><path d="M19 14V6c0-1.1-.9-2-2-2H3c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zm-9-1c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm13-6v11c0 1.1-.9 2-2 2H4v-2h17V7h2z"/></svg>
                    </div>
                    <div class="quick-stat-content">
                        <h4 id="statDeposited">0</h4>
                        <p>Total Deposits</p>
                    </div>
                </div>
                <div class="quick-stat-card">
                    <div class="quick-stat-icon green">
                        <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
                    </div>
                    <div class="quick-stat-content">
                        <h4 id="statCleared">0</h4>
                        <p>Cleared</p>
                    </div>
                </div>
                <div class="quick-stat-card">
                    <div class="quick-stat-icon purple">
                        <svg viewBox="0 0 24 24"><path d="M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4z"/></svg>
                    </div>
                    <div class="quick-stat-content">
                        <h4 id="statTotalAmount">NPR 0</h4>
                        <p>Total Deposited</p>
                    </div>
                </div>
            </div>

            <!-- Step Indicator -->
            <div class="step-indicator">
                <div class="step completed">
                    <div class="step-number">
                        <svg viewBox="0 0 24 24" width="20" height="20" fill="white"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
                    </div>
                    <div class="step-info">
                        <div class="step-title">Cheque Entry</div>
                        <div class="step-subtitle">Record cheque details</div>
                    </div>
                </div>
                <div class="step-connector active"></div>
                <div class="step active">
                    <div class="step-number">2</div>
                    <div class="step-info">
                        <div class="step-title">Bank Deposit</div>
                        <div class="step-subtitle">Select & deposit cheques</div>
                    </div>
                </div>
                <div class="step-connector"></div>
                <div class="step">
                    <div class="step-number">3</div>
                    <div class="step-info">
                        <div class="step-title">Clearance</div>
                        <div class="step-subtitle">Track clearing status</div>
                    </div>
                </div>
            </div>

            <!-- Content Layout -->
            <div class="content-layout">
                <!-- Pending Cheques Section -->
                <div class="pending-cheques-section">
                    <div class="section-header">
                        <div class="section-header-left">
                            <div class="section-header-icon orange">
                                <svg viewBox="0 0 24 24"><path d="M19 14V6c0-1.1-.9-2-2-2H3c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zm-9-1c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm13-6v11c0 1.1-.9 2-2 2H4v-2h17V7h2z"/></svg>
                            </div>
                            <div>
                                <h3>Pending Cheques</h3>
                                <p>Select cheques that you have deposited at the bank</p>
                            </div>
                        </div>
                        <div class="section-header-right">
                            <div class="select-all-wrapper">
                                <input type="checkbox" id="selectAll" onchange="toggleSelectAll()">
                                <label for="selectAll">Select All</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="cheque-list" id="chequeList">
                        <!-- Cheques will be loaded here -->
                    </div>
                </div>

                <!-- Deposit Form Section -->
                <div class="deposit-form-section">
                    <div class="deposit-form-header">
                        <h3>
                            <svg viewBox="0 0 24 24"><path d="M4 10h3v7H4zm6 0h3v7h-3zm-8 9h19v3H2zm14-9h3v7h-3zm-4.5-9L2 6v2h19V6z"/></svg>
                            Deposit Details
                        </h3>
                        <p>Enter where you deposited the cheques</p>
                    </div>

                    <div class="selected-summary">
                        <div class="selected-summary-title">Selected Cheques Summary</div>
                        <div class="selected-stats">
                            <div class="selected-stat">
                                <div class="selected-stat-value" id="selectedCount">0</div>
                                <div class="selected-stat-label">Cheques Selected</div>
                            </div>
                            <div class="selected-stat">
                                <div class="selected-stat-value amount" id="selectedAmount">NPR 0</div>
                                <div class="selected-stat-label">Total Amount</div>
                            </div>
                        </div>
                    </div>

                    <form class="deposit-form" id="depositForm">
                        <div class="form-group">
                            <label class="form-label">
                                Deposit Bank
                                <span class="required">*</span>
                            </label>
                            <select class="form-select" id="depositBank" required>
                                <option value="">Select deposit bank</option>
                                <optgroup label="Class A - Commercial Banks">
                                    <option value="Nabil Bank">Nabil Bank Limited</option>
                                    <option value="Nepal Investment Mega Bank">Nepal Investment Mega Bank Limited</option>
                                    <option value="Standard Chartered Bank">Standard Chartered Bank Nepal Limited</option>
                                    <option value="Himalayan Bank">Himalayan Bank Limited</option>
                                    <option value="Nepal SBI Bank">Nepal SBI Bank Limited</option>
                                    <option value="Nepal Bank">Nepal Bank Limited</option>
                                    <option value="Rastriya Banijya Bank">Rastriya Banijya Bank Limited</option>
                                    <option value="Everest Bank">Everest Bank Limited</option>
                                    <option value="Bank of Kathmandu">Bank of Kathmandu Limited</option>
                                    <option value="NIC Asia Bank">NIC Asia Bank Limited</option>
                                    <option value="Machhapuchchhre Bank">Machhapuchchhre Bank Limited</option>
                                    <option value="Kumari Bank">Kumari Bank Limited</option>
                                    <option value="Laxmi Sunrise Bank">Laxmi Sunrise Bank Limited</option>
                                    <option value="Siddhartha Bank">Siddhartha Bank Limited</option>
                                    <option value="Global IME Bank">Global IME Bank Limited</option>
                                    <option value="Citizens Bank">Citizens Bank International Limited</option>
                                    <option value="Prime Commercial Bank">Prime Commercial Bank Limited</option>
                                    <option value="NMB Bank">NMB Bank Limited</option>
                                    <option value="Prabhu Bank">Prabhu Bank Limited</option>
                                    <option value="Sanima Bank">Sanima Bank Limited</option>
                                </optgroup>
                                <optgroup label="Class B - Development Banks">
                                    <option value="Kamana Sewa Bikas Bank">Kamana Sewa Bikas Bank Limited</option>
                                    <option value="Jyoti Bikas Bank">Jyoti Bikas Bank Limited</option>
                                    <option value="Garima Bikas Bank">Garima Bikas Bank Limited</option>
                                    <option value="Muktinath Bikas Bank">Muktinath Bikas Bank Limited</option>
                                    <option value="Lumbini Bikas Bank">Lumbini Bikas Bank Limited</option>
                                </optgroup>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                Branch Name
                                <span class="required">*</span>
                            </label>
                            <input type="text" class="form-input" id="branchName" placeholder="e.g., Kathmandu Main Branch" required>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">
                                    Deposit Date
                                    <span class="required">*</span>
                                </label>
                                <input type="date" class="form-input" id="depositDate" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">
                                    Deposit Slip No.
                                </label>
                                <input type="text" class="form-input" id="depositSlipNo" placeholder="e.g., DS-12345">
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                Account Number
                            </label>
                            <input type="text" class="form-input" id="accountNumber" placeholder="Your account number">
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                Remarks
                            </label>
                            <textarea class="form-textarea" id="depositRemarks" placeholder="Any additional notes..."></textarea>
                        </div>

                        <div class="form-actions">
                            <button type="submit" class="btn btn-success" id="submitDeposit" disabled>
                                <svg viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
                                Record Deposit
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Deposit History Section -->
            <div class="deposit-history-section">
                <div class="section-header">
                    <div class="section-header-left">
                        <div class="section-header-icon green">
                            <svg viewBox="0 0 24 24"><path d="M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"/></svg>
                        </div>
                        <div>
                            <h3>Deposit History</h3>
                            <p>View all your deposit records</p>
                        </div>
                    </div>
                    <div class="section-header-right">
                        <button class="btn btn-excel" onclick="exportDepositsToExcel()">
                            <svg viewBox="0 0 24 24" width="18" height="18">
                                <path fill="currentColor" d="M21.17 3.25Q21.5 3.25 21.76 3.5 22 3.74 22 4.08V19.92Q22 20.26 21.76 20.5 21.5 20.75 21.17 20.75H7.83Q7.5 20.75 7.24 20.5 7 20.26 7 19.92V17H2.83Q2.5 17 2.24 16.76 2 16.5 2 16.17V7.83Q2 7.5 2.24 7.24 2.5 7 2.83 7H7V4.08Q7 3.74 7.24 3.5 7.5 3.25 7.83 3.25M7 13.06L8.18 15.28H9.97L8 12.06L9.93 8.89H8.22L7.13 10.9L7.09 10.96L7.06 11.03Q6.8 10.5 6.5 9.96 6.25 9.43 5.97 8.89H4.16L6.05 12.08L4 15.28H5.78M13.88 19.5V17H8.25V19.5M13.88 15.75V12.63H12V15.75M13.88 11.38V8.25H12V11.38M13.88 7V4.5H8.25V7M20.75 19.5V17H15.13V19.5M20.75 15.75V12.63H15.13V15.75M20.75 11.38V8.25H15.13V11.38M20.75 7V4.5H15.13V7Z"/>
                            </svg>
                            Export to Excel
                        </button>
                    </div>
                </div>
                <div class="table-wrapper">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Deposit ID</th>
                                <th>Deposit Bank</th>
                                <th>Branch</th>
                                <th>Cheques</th>
                                <th>Total Amount</th>
                                <th>Date</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="depositHistoryBody">
                            <!-- Deposit history will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </main>

        <footer class="footer">
            <p> 2024 ChequeTracker. All rights reserved.</p>
        </footer>
    </div>

    <!-- View Deposit Modal -->
    <div class="modal-overlay" id="viewModal">
        <div class="modal">
            <div class="modal-header">
                <h3>Deposit Details</h3>
                <button class="modal-close" onclick="closeViewModal()">
                    <svg viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                </button>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- Modal content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <script>
        // Constants
        const CHEQUES_KEY = 'chequeTrackerData';
        const DEPOSITS_KEY = 'chequeDepositsData';
        const NOTIFICATIONS_KEY = 'chequeTrackerNotifications';

        // State
        let chequeEntries = [];
        let depositRecords = [];
        let notifications = [];
        let selectedCheques = new Set();

        // ==================== NOTIFICATION SYSTEM ====================

        // Load Notifications
        function loadNotifications() {
            const saved = localStorage.getItem(NOTIFICATIONS_KEY);
            if (saved) {
                notifications = JSON.parse(saved);
            }
            // Generate notifications based on data state
            generateAutoNotifications();
            renderNotifications();
            updateNotificationBadge();
        }

        // Save Notifications
        function saveNotifications() {
            localStorage.setItem(NOTIFICATIONS_KEY, JSON.stringify(notifications));
        }

        // Generate Auto Notifications
        function generateAutoNotifications() {
            const pendingCheques = chequeEntries.filter(c => c.status === 'pending');
            const processingCheques = chequeEntries.filter(c => c.status === 'processing');
            
            // Check for pending cheques notification
            if (pendingCheques.length > 0) {
                const existingPending = notifications.find(n => n.type === 'pending-reminder' && !n.read);
                if (!existingPending) {
                    addNotification({
                        type: 'pending-reminder',
                        category: 'warning',
                        title: 'Pending Cheques',
                        message: `You have ${pendingCheques.length} cheque(s) waiting to be deposited. Don't forget to deposit them at the bank.`,
                        persistent: true
                    });
                }
            }

            // Check for processing cheques
            if (processingCheques.length > 0) {
                const existingProcessing = notifications.find(n => n.type === 'processing-info' && !n.read);
                if (!existingProcessing) {
                    addNotification({
                        type: 'processing-info',
                        category: 'info',
                        title: 'Cheques Being Processed',
                        message: `${processingCheques.length} cheque(s) are currently being processed by the bank.`,
                        persistent: true
                    });
                }
            }
        }

        // Add Notification
        function addNotification(data) {
            const notification = {
                id: Date.now() + Math.random().toString(36).substr(2, 9),
                type: data.type || 'general',
                category: data.category || 'info', // success, warning, info, error
                title: data.title,
                message: data.message,
                read: false,
                timestamp: new Date().toISOString(),
                persistent: data.persistent || false
            };
            
            // Add to beginning of array
            notifications.unshift(notification);
            
            // Keep only last 50 notifications
            if (notifications.length > 50) {
                notifications = notifications.slice(0, 50);
            }
            
            saveNotifications();
            renderNotifications();
            updateNotificationBadge();
            
            return notification;
        }

        // Render Notifications
        function renderNotifications() {
            const container = document.getElementById('notificationList');
            const unreadCount = notifications.filter(n => !n.read).length;
            
            document.getElementById('notificationCount').textContent = unreadCount;
            
            if (notifications.length === 0) {
                container.innerHTML = `
                    <div class="notification-empty">
                        <div class="notification-empty-icon">
                            <svg viewBox="0 0 24 24"><path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"/></svg>
                        </div>
                        <h5>No Notifications</h5>
                        <p>You're all caught up!</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = notifications.slice(0, 10).map(notification => `
                <div class="notification-item ${notification.read ? '' : 'unread'}" onclick="markAsRead('${notification.id}')">
                    <div class="notification-icon ${notification.category}">
                        ${getNotificationIcon(notification.category)}
                    </div>
                    <div class="notification-content">
                        <div class="notification-title">${notification.title}</div>
                        <div class="notification-message">${notification.message}</div>
                        <div class="notification-time">
                            <svg viewBox="0 0 24 24"><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/></svg>
                            ${getTimeAgo(notification.timestamp)}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Get Notification Icon
        function getNotificationIcon(category) {
            const icons = {
                success: '<svg viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>',
                warning: '<svg viewBox="0 0 24 24"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>',
                info: '<svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>',
                error: '<svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>'
            };
            return icons[category] || icons.info;
        }

        // Get Time Ago
        function getTimeAgo(timestamp) {
            const now = new Date();
            const then = new Date(timestamp);
            const diffMs = now - then;
            const diffMins = Math.floor(diffMs / 60000);
            const diffHours = Math.floor(diffMs / 3600000);
            const diffDays = Math.floor(diffMs / 86400000);
            
            if (diffMins < 1) return 'Just now';
            if (diffMins < 60) return `${diffMins} min${diffMins > 1 ? 's' : ''} ago`;
            if (diffHours < 24) return `${diffHours} hour${diffHours > 1 ? 's' : ''} ago`;
            if (diffDays < 7) return `${diffDays} day${diffDays > 1 ? 's' : ''} ago`;
            return then.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
        }

        // Update Notification Badge
        function updateNotificationBadge() {
            const unreadCount = notifications.filter(n => !n.read).length;
            const badge = document.getElementById('notificationBadge');
            badge.textContent = unreadCount > 9 ? '9+' : unreadCount;
            badge.setAttribute('data-count', unreadCount);
        }

        // Toggle Notification Dropdown
        function toggleNotificationDropdown() {
            const dropdown = document.getElementById('notificationDropdown');
            dropdown.classList.toggle('active');
        }

        // Mark as Read
        function markAsRead(id) {
            const notification = notifications.find(n => n.id === id);
            if (notification) {
                notification.read = true;
                saveNotifications();
                renderNotifications();
                updateNotificationBadge();
            }
        }

        // Mark All as Read
        function markAllAsRead() {
            notifications.forEach(n => n.read = true);
            saveNotifications();
            renderNotifications();
            updateNotificationBadge();
            showToast('success', 'All Read', 'All notifications marked as read');
        }

        // Clear All Notifications
        function clearAllNotifications() {
            notifications = [];
            saveNotifications();
            renderNotifications();
            updateNotificationBadge();
            showToast('success', 'Cleared', 'All notifications have been cleared');
        }

        // View All Notifications
        function viewAllNotifications() {
            showToast('info', 'Coming Soon', 'Full notification center will be available soon');
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
            const wrapper = document.querySelector('.notification-wrapper');
            const dropdown = document.getElementById('notificationDropdown');
            
            if (wrapper && !wrapper.contains(e.target)) {
                dropdown.classList.remove('active');
            }
        });

        // ==================== HELPER FUNCTIONS ====================

        function formatNepaliNumber(num) {
            const numStr = Math.floor(num).toString();
            let result = '';
            let count = 0;
            
            for (let i = numStr.length - 1; i >= 0; i--) {
                count++;
                result = numStr[i] + result;
                
                if (count === 3 && i !== 0) {
                    result = ',' + result;
                } else if (count > 3 && (count - 3) % 2 === 0 && i !== 0) {
                    result = ',' + result;
                }
            }
            
            return result;
        }

        function formatDate(dateStr) {
            const date = new Date(dateStr);
            return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
        }

        function generateDepositId() {
            const date = new Date();
            const random = Math.floor(Math.random() * 1000).toString().padStart(3, '0');
            return `DEP-${date.getFullYear()}${(date.getMonth()+1).toString().padStart(2,'0')}${date.getDate().toString().padStart(2,'0')}-${random}`;
        }

        // ==================== DATA MANAGEMENT ====================

        function loadData() {
            const savedCheques = localStorage.getItem(CHEQUES_KEY);
            const savedDeposits = localStorage.getItem(DEPOSITS_KEY);
            
            if (savedCheques) {
                chequeEntries = JSON.parse(savedCheques);
            }
            if (savedDeposits) {
                depositRecords = JSON.parse(savedDeposits);
            }
            
            renderPendingCheques();
            renderDepositHistory();
            updateStats();
            setDefaultDate();
            loadNotifications();
        }

        function saveData() {
            localStorage.setItem(CHEQUES_KEY, JSON.stringify(chequeEntries));
            localStorage.setItem(DEPOSITS_KEY, JSON.stringify(depositRecords));
        }

        function setDefaultDate() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('depositDate').value = today;
        }

        // ==================== RENDER FUNCTIONS ====================

        function renderPendingCheques() {
            const container = document.getElementById('chequeList');
            const pendingCheques = chequeEntries.filter(c => c.status === 'pending');
            
            if (pendingCheques.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">
                            <svg viewBox="0 0 24 24"><path d="M19 14V6c0-1.1-.9-2-2-2H3c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zm-9-1c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm13-6v11c0 1.1-.9 2-2 2H4v-2h17V7h2z"/></svg>
                        </div>
                        <h4>No Pending Cheques</h4>
                        <p>All cheques have been deposited. Add new cheques in the Cheque In section.</p>
                        <a href="cheque-in.html" class="btn btn-primary">
                            <svg viewBox="0 0 24 24"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
                            Add New Cheque
                        </a>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = pendingCheques.map((cheque, index) => {
                const originalIndex = chequeEntries.indexOf(cheque);
                const isSelected = selectedCheques.has(originalIndex);
                return `
                    <div class="cheque-item ${isSelected ? 'selected' : ''}" onclick="toggleCheque(${originalIndex}, event)">
                        <input type="checkbox" class="cheque-checkbox" 
                               ${isSelected ? 'checked' : ''} 
                               data-index="${originalIndex}"
                               onclick="event.stopPropagation()">
                        <div class="cheque-info">
                            <div class="cheque-detail">
                                <span class="cheque-detail-label">Cheque No</span>
                                <span class="cheque-detail-value highlight">${cheque.chequeNo}</span>
                            </div>
                            <div class="cheque-detail">
                                <span class="cheque-detail-label">Account Name</span>
                                <span class="cheque-detail-value">${cheque.accountName}</span>
                            </div>
                            <div class="cheque-detail">
                                <span class="cheque-detail-label">Bank</span>
                                <span class="cheque-detail-value">${cheque.chequeBank}</span>
                            </div>
                            <div class="cheque-detail">
                                <span class="cheque-detail-label">Amount</span>
                                <span class="cheque-detail-value amount">NPR ${formatNepaliNumber(cheque.amount)}</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function toggleCheque(index, event) {
            if (event) {
                const checkbox = event.currentTarget.querySelector('.cheque-checkbox');
                if (event.target !== checkbox) {
                    checkbox.checked = !checkbox.checked;
                }
            }
            
            if (selectedCheques.has(index)) {
                selectedCheques.delete(index);
            } else {
                selectedCheques.add(index);
            }
            
            updateSelectedSummary();
            renderPendingCheques();
            updateSelectAllCheckbox();
        }

        function toggleSelectAll() {
            const selectAll = document.getElementById('selectAll');
            const pendingCheques = chequeEntries.filter(c => c.status === 'pending');
            
            if (selectAll.checked) {
                pendingCheques.forEach(cheque => {
                    const index = chequeEntries.indexOf(cheque);
                    selectedCheques.add(index);
                });
            } else {
                selectedCheques.clear();
            }
            
            updateSelectedSummary();
            renderPendingCheques();
        }

        function updateSelectAllCheckbox() {
            const selectAll = document.getElementById('selectAll');
            const pendingCheques = chequeEntries.filter(c => c.status === 'pending');
            const allSelected = pendingCheques.length > 0 && 
                               pendingCheques.every(c => selectedCheques.has(chequeEntries.indexOf(c)));
            selectAll.checked = allSelected;
        }

        function updateSelectedSummary() {
            const count = selectedCheques.size;
            let totalAmount = 0;
            
            selectedCheques.forEach(index => {
                totalAmount += parseFloat(chequeEntries[index].amount) || 0;
            });
            
            document.getElementById('selectedCount').textContent = count;
            document.getElementById('selectedAmount').textContent = 'NPR ' + formatNepaliNumber(totalAmount);
            
            document.getElementById('submitDeposit').disabled = count === 0;
        }

        function updateStats() {
            const pending = chequeEntries.filter(c => c.status === 'pending').length;
            const deposited = depositRecords.length;
            const cleared = chequeEntries.filter(c => c.status === 'cleared').length;
            
            let totalDeposited = 0;
            depositRecords.forEach(d => {
                totalDeposited += parseFloat(d.totalAmount) || 0;
            });
            
            document.getElementById('statPending').textContent = pending;
            document.getElementById('statDeposited').textContent = deposited;
            document.getElementById('statCleared').textContent = cleared;
            document.getElementById('statTotalAmount').textContent = 'NPR ' + formatNepaliNumber(totalDeposited);
            document.getElementById('pendingBadge').textContent = pending;
        }

        function renderDepositHistory() {
            const tbody = document.getElementById('depositHistoryBody');
            
            if (depositRecords.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="8" style="text-align: center; padding: 40px; color: var(--text-muted);">
                            No deposit records yet. Select cheques and record your first deposit.
                        </td>
                    </tr>
                `;
                return;
            }
            
            tbody.innerHTML = depositRecords.map((deposit, index) => `
                <tr>
                    <td class="deposit-id">${deposit.depositId}</td>
                    <td>${deposit.depositBank}</td>
                    <td>${deposit.branchName}</td>
                    <td>
                        <span class="deposit-cheques-count">
                            <svg viewBox="0 0 24 24" width="14" height="14" fill="currentColor"><path d="M19 14V6c0-1.1-.9-2-2-2H3c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2z"/></svg>
                            ${deposit.cheques.length} Cheques
                        </span>
                    </td>
                    <td class="deposit-amount">NPR ${formatNepaliNumber(deposit.totalAmount)}</td>
                    <td>${formatDate(deposit.depositDate)}</td>
                    <td>
                        <span class="table-status ${deposit.status}">
                            <span class="cheque-status-dot"></span>
                            ${deposit.status.charAt(0).toUpperCase() + deposit.status.slice(1)}
                        </span>
                    </td>
                    <td>
                        <div class="table-actions">
                            <button class="table-action-btn view" title="View Details" onclick="viewDeposit(${index})">
                                <svg viewBox="0 0 24 24"><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        // ==================== FORM SUBMISSION ====================

        document.getElementById('depositForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (selectedCheques.size === 0) {
                showToast('error', 'No Cheques Selected', 'Please select at least one cheque to deposit.');
                return;
            }
            
            const depositBank = document.getElementById('depositBank').value;
            const branchName = document.getElementById('branchName').value;
            const depositDate = document.getElementById('depositDate').value;
            const depositSlipNo = document.getElementById('depositSlipNo').value;
            const accountNumber = document.getElementById('accountNumber').value;
            const remarks = document.getElementById('depositRemarks').value;
            
            if (!depositBank || !branchName || !depositDate) {
                showToast('error', 'Missing Information', 'Please fill in all required fields.');
                return;
            }
            
            // Get selected cheques data
            const chequesData = [];
            let totalAmount = 0;
            
            selectedCheques.forEach(index => {
                const cheque = chequeEntries[index];
                chequesData.push({
                    chequeNo: cheque.chequeNo,
                    accountName: cheque.accountName,
                    chequeBank: cheque.chequeBank,
                    amount: cheque.amount,
                    chequeDate: cheque.chequeDate
                });
                totalAmount += parseFloat(cheque.amount) || 0;
                
                // Update cheque status
                chequeEntries[index].status = 'processing';
                chequeEntries[index].depositedAt = new Date().toISOString();
            });
            
            // Create deposit record
            const depositRecord = {
                depositId: generateDepositId(),
                depositBank: depositBank,
                branchName: branchName,
                depositDate: depositDate,
                depositSlipNo: depositSlipNo,
                accountNumber: accountNumber,
                remarks: remarks,
                cheques: chequesData,
                totalAmount: totalAmount,
                status: 'processing',
                createdAt: new Date().toISOString()
            };
            
            depositRecords.unshift(depositRecord);
            
            // Save and update UI
            saveData();
            selectedCheques.clear();
            updateSelectedSummary();
            renderPendingCheques();
            renderDepositHistory();
            updateStats();
            
            // Reset form
            document.getElementById('depositForm').reset();
            setDefaultDate();
            
            // Add notification
            addNotification({
                type: 'deposit-success',
                category: 'success',
                title: 'Deposit Recorded Successfully!',
                message: `${chequesData.length} cheque(s) totaling NPR ${formatNepaliNumber(totalAmount)} deposited at ${depositBank}, ${branchName}.`
            });
            
            showToast('success', 'Deposit Recorded Successfully!', 
                `${chequesData.length} cheques totaling NPR ${formatNepaliNumber(totalAmount)} have been recorded.`);
            
            // Regenerate auto notifications
            generateAutoNotifications();
            renderNotifications();
            updateNotificationBadge();
        });

        // ==================== MODAL FUNCTIONS ====================

        function viewDeposit(index) {
            const deposit = depositRecords[index];
            
            const modalBody = document.getElementById('modalBody');
            modalBody.innerHTML = `
                <div class="modal-section">
                    <div class="modal-section-title">Deposit Information</div>
                    <div class="modal-info-grid">
                        <div class="modal-info-item">
                            <div class="modal-info-label">Deposit ID</div>
                            <div class="modal-info-value highlight">${deposit.depositId}</div>
                        </div>
                        <div class="modal-info-item">
                            <div class="modal-info-label">Deposit Date</div>
                            <div class="modal-info-value">${formatDate(deposit.depositDate)}</div>
                        </div>
                        <div class="modal-info-item">
                            <div class="modal-info-label">Deposit Bank</div>
                            <div class="modal-info-value">${deposit.depositBank}</div>
                        </div>
                        <div class="modal-info-item">
                            <div class="modal-info-label">Branch</div>
                            <div class="modal-info-value">${deposit.branchName}</div>
                        </div>
                        <div class="modal-info-item">
                            <div class="modal-info-label">Deposit Slip No.</div>
                            <div class="modal-info-value">${deposit.depositSlipNo || 'N/A'}</div>
                        </div>
                        <div class="modal-info-item">
                            <div class="modal-info-label">Account Number</div>
                            <div class="modal-info-value">${deposit.accountNumber || 'N/A'}</div>
                        </div>
                        <div class="modal-info-item">
                            <div class="modal-info-label">Total Cheques</div>
                            <div class="modal-info-value">${deposit.cheques.length}</div>
                        </div>
                        <div class="modal-info-item">
                            <div class="modal-info-label">Total Amount</div>
                            <div class="modal-info-value amount">NPR ${formatNepaliNumber(deposit.totalAmount)}</div>
                        </div>
                    </div>
                    ${deposit.remarks ? `
                        <div class="modal-info-item" style="margin-top: 16px;">
                            <div class="modal-info-label">Remarks</div>
                            <div class="modal-info-value">${deposit.remarks}</div>
                        </div>
                    ` : ''}
                </div>
                
                <div class="modal-section">
                    <div class="modal-section-title">Cheques in this Deposit</div>
                    <div class="modal-cheques-list">
                        <div class="modal-cheque-item header">
                            <span>Cheque No.</span>
                            <span>Account Name</span>
                            <span>Bank</span>
                            <span>Amount</span>
                        </div>
                        ${deposit.cheques.map(c => `
                            <div class="modal-cheque-item">
                                <span style="font-weight: 600; color: var(--primary);">${c.chequeNo}</span>
                                <span>${c.accountName}</span>
                                <span>${c.chequeBank}</span>
                                <span style="font-weight: 700; color: var(--success);">NPR ${formatNepaliNumber(c.amount)}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            
            document.getElementById('viewModal').classList.add('active');
        }

        function closeViewModal() {
            document.getElementById('viewModal').classList.remove('active');
        }

        // ==================== EXPORT FUNCTIONS ====================

        function exportDepositsToExcel() {
            if (depositRecords.length === 0) {
                showToast('error', 'No Data', 'There are no deposits to export.');
                return;
            }
            
            const excelData = [];
            
            depositRecords.forEach((deposit, dIndex) => {
                deposit.cheques.forEach((cheque, cIndex) => {
                    excelData.push({
                        'Deposit ID': deposit.depositId,
                        'Deposit Bank': deposit.depositBank,
                        'Branch': deposit.branchName,
                        'Deposit Date': formatDate(deposit.depositDate),
                        'Deposit Slip No.': deposit.depositSlipNo || '',
                        'Account Number': deposit.accountNumber || '',
                        'Cheque No.': cheque.chequeNo,
                        'Account Holder': cheque.accountName,
                        'Cheque Bank': cheque.chequeBank,
                        'Cheque Amount': cheque.amount,
                        'Cheque Date': formatDate(cheque.chequeDate),
                        'Status': deposit.status.charAt(0).toUpperCase() + deposit.status.slice(1),
                        'Remarks': deposit.remarks || ''
                    });
                });
            });
            
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.json_to_sheet(excelData);
            
            ws['!cols'] = [
                { wch: 20 }, { wch: 25 }, { wch: 20 }, { wch: 15 },
                { wch: 15 }, { wch: 18 }, { wch: 15 }, { wch: 25 },
                { wch: 20 }, { wch: 15 }, { wch: 15 }, { wch: 12 }, { wch: 30 }
            ];
            
            XLSX.utils.book_append_sheet(wb, ws, 'Deposit Records');
            
            const filename = `Deposit_Records_${new Date().toISOString().split('T')[0]}.xlsx`;
            XLSX.writeFile(wb, filename);
            
            // Add notification
            addNotification({
                type: 'export-success',
                category: 'success',
                title: 'Export Completed',
                message: `Deposit records have been exported to ${filename}`
            });
            
            showToast('success', 'Export Successful', `Deposit records exported to ${filename}`);
        }

        // ==================== TOAST NOTIFICATION ====================

        function showToast(type, title, message) {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            const iconSvg = type === 'success' 
                ? '<svg viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>'
                : type === 'warning'
                ? '<svg viewBox="0 0 24 24"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>'
                : type === 'info'
                ? '<svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>'
                : '<svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>';
            
            toast.innerHTML = `
                <div class="toast-icon">${iconSvg}</div>
                <div class="toast-content">
                    <div class="toast-title">${title}</div>
                    <div class="toast-message">${message}</div>
                </div>
                <button class="toast-close" onclick="this.parentElement.remove()">
                    <svg viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                </button>
            `;

            container.appendChild(toast);

            setTimeout(() => {
                toast.style.animation = 'slideOutRight 0.3s ease-out forwards';
                setTimeout(() => toast.remove(), 300);
            }, 5000);
        }

        // ==================== THEME TOGGLE ====================

        function toggleTheme() {
            const body = document.body;
            const currentTheme = body.getAttribute('data-theme');
            body.setAttribute('data-theme', currentTheme === 'dark' ? '' : 'dark');
            localStorage.setItem('theme', currentTheme === 'dark' ? 'light' : 'dark');
        }

        // ==================== TIME UPDATE ====================

        function updateTime() {
            const now = new Date();
            const timeOptions = { hour: '2-digit', minute: '2-digit', hour12: true };
            const dateOptions = { weekday: 'short', month: 'short', day: 'numeric' };
            
            document.getElementById('currentTime').textContent = now.toLocaleTimeString('en-US', timeOptions);
            document.getElementById('currentDate').textContent = now.toLocaleDateString('en-US', dateOptions);
        }

        // ==================== INITIALIZE ====================

        window.addEventListener('load', () => {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.body.setAttribute('data-theme', 'dark');
            }

            loadData();
            updateTime();
            setInterval(updateTime, 1000);
        });

        // Close modal on overlay click
        document.getElementById('viewModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeViewModal();
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeViewModal();
                document.getElementById('notificationDropdown').classList.remove('active');
            }
        });
    </script>
</body>
</html>