<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cheque In | ChequeTracker</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary: #0052CC;
            --primary-hover: #0065FF;
            --primary-light: rgba(0, 82, 204, 0.08);
            --accent: #0065FF;
            --accent-hover: #2684FF;
            --accent-light: rgba(0, 101, 255, 0.1);
            --text-primary: #172B4D;
            --text-secondary: #5E6C84;
            --text-muted: #97A0AF;
            --bg-primary: #FFFFFF;
            --bg-secondary: #F4F5F7;
            --bg-tertiary: #EBECF0;
            --border: #DFE1E6;
            --border-focus: #0052CC;
            --success: #00875A;
            --success-light: rgba(0, 135, 90, 0.1);
            --error: #DE350B;
            --error-light: rgba(222, 53, 11, 0.1);
            --warning: #FF991F;
            --warning-light: rgba(255, 153, 31, 0.1);
            --info: #0065FF;
            --info-light: rgba(0, 101, 255, 0.1);
            --shadow-sm: 0 1px 2px rgba(9, 30, 66, 0.08);
            --shadow-md: 0 4px 8px rgba(9, 30, 66, 0.1);
            --shadow-lg: 0 8px 16px rgba(9, 30, 66, 0.12);
            --shadow-xl: 0 16px 32px rgba(9, 30, 66, 0.15);
            --radius-sm: 4px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --radius-xl: 16px;
            --transition: all 0.2s ease;
            --transition-slow: all 0.3s ease;
            --header-bg: linear-gradient(135deg, #0052CC 0%, #0747A6 100%);
            --sidebar-width: 260px;
        }

        [data-theme="dark"] {
            --primary: #4C9AFF;
            --primary-hover: #79B8FF;
            --primary-light: rgba(76, 154, 255, 0.12);
            --accent: #4C9AFF;
            --accent-hover: #79B8FF;
            --accent-light: rgba(76, 154, 255, 0.12);
            --text-primary: #E6E8EB;
            --text-secondary: #B8C1CC;
            --text-muted: #8C95A0;
            --bg-primary: #161B22;
            --bg-secondary: #0D1117;
            --bg-tertiary: #21262D;
            --border: #30363D;
            --border-focus: #4C9AFF;
            --success-light: rgba(0, 135, 90, 0.2);
            --error-light: rgba(222, 53, 11, 0.2);
            --warning-light: rgba(255, 153, 31, 0.2);
            --info-light: rgba(0, 101, 255, 0.2);
            --header-bg: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            height: 100%;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-secondary);
            min-height: 100vh;
            color: var(--text-primary);
            transition: var(--transition);
            -webkit-font-smoothing: antialiased;
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            bottom: 0;
            width: var(--sidebar-width);
            background: var(--header-bg);
            padding: 24px 0;
            z-index: 100;
            overflow: hidden;
        }

        .sidebar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: radial-gradient(rgba(255,255,255,0.03) 1px, transparent 1px);
            background-size: 20px 20px;
            pointer-events: none;
        }

        .sidebar-shapes {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            overflow: hidden;
            pointer-events: none;
        }

        .sidebar-circle {
            position: absolute;
            border-radius: 50%;
            background: linear-gradient(135deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.02) 100%);
            border: 1px solid rgba(255,255,255,0.05);
        }

        .sidebar-circle-1 { width: 150px; height: 150px; top: -50px; right: -50px; animation: float1 20s ease-in-out infinite; }
        .sidebar-circle-2 { width: 100px; height: 100px; bottom: 20%; left: -30px; animation: float2 25s ease-in-out infinite; }
        .sidebar-circle-3 { width: 80px; height: 80px; bottom: -20px; right: 20px; animation: float3 18s ease-in-out infinite; }

        @keyframes float1 { 0%, 100% { transform: translate(0, 0); } 50% { transform: translate(-10px, 20px); } }
        @keyframes float2 { 0%, 100% { transform: translate(0, 0); } 50% { transform: translate(20px, -15px); } }
        @keyframes float3 { 0%, 100% { transform: translate(0, 0); } 50% { transform: translate(-15px, -10px); } }

        .sidebar-logo {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 0 24px;
            margin-bottom: 32px;
            position: relative;
            z-index: 1;
        }

        .sidebar-logo .logo-icon {
            width: 42px;
            height: 42px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .sidebar-logo .logo-icon svg {
            width: 22px;
            height: 22px;
            fill: white;
        }

        .sidebar-logo .logo-text {
            display: flex;
            flex-direction: column;
        }

        .sidebar-logo .logo-text span:first-child {
            font-size: 18px;
            font-weight: 700;
            color: white;
            letter-spacing: -0.3px;
        }

        .sidebar-logo .logo-text span:last-child {
            font-size: 10px;
            color: rgba(255, 255, 255, 0.6);
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .sidebar-nav {
            padding: 0 12px;
            position: relative;
            z-index: 1;
        }

        .nav-section {
            margin-bottom: 24px;
        }

        .nav-section-title {
            font-size: 10px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.4);
            text-transform: uppercase;
            letter-spacing: 1.5px;
            padding: 0 12px;
            margin-bottom: 8px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            border-radius: var(--radius-md);
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            transition: var(--transition);
            margin-bottom: 4px;
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .nav-item.active {
            background: rgba(255, 255, 255, 0.15);
            color: white;
        }

        .nav-item svg {
            width: 20px;
            height: 20px;
            fill: currentColor;
            flex-shrink: 0;
        }

        .nav-item .badge {
            margin-left: auto;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 11px;
            font-weight: 600;
            padding: 2px 8px;
            border-radius: 10px;
        }

        .nav-item .badge.alert {
            background: var(--error);
        }

        .sidebar-footer {
            position: absolute;
            bottom: 24px;
            left: 12px;
            right: 12px;
            z-index: 1;
        }

        .sidebar-user {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-lg);
            margin-bottom: 12px;
        }

        .sidebar-user-avatar {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #4C9AFF 0%, #00C7E6 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .sidebar-user-avatar svg {
            width: 20px;
            height: 20px;
            fill: white;
        }

        .sidebar-user-info {
            flex: 1;
            min-width: 0;
        }

        .sidebar-user-name {
            font-size: 13px;
            font-weight: 600;
            color: white;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .sidebar-user-role {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.6);
        }

        .logout-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-md);
            color: rgba(255, 255, 255, 0.8);
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
        }

        .logout-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            color: white;
        }

        .logout-btn svg {
            width: 18px;
            height: 18px;
            fill: currentColor;
        }

        /* Main Content */
        .main-wrapper {
            margin-left: var(--sidebar-width);
            min-height: 100vh;
        }

        /* Header */
        .header {
            background: var(--bg-primary);
            border-bottom: 1px solid var(--border);
            padding: 16px 32px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 50;
        }

        .header-left {
            display: flex;
            flex-direction: column;
        }

        .header-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-primary);
            letter-spacing: -0.5px;
        }

        .header-subtitle {
            font-size: 13px;
            color: var(--text-secondary);
            margin-top: 2px;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .header-datetime {
            text-align: right;
            padding-right: 16px;
            border-right: 1px solid var(--border);
        }

        .header-time {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .header-date {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .header-btn {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-md);
            border: 1px solid var(--border);
            background: var(--bg-primary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            position: relative;
        }

        .header-btn:hover {
            background: var(--bg-secondary);
            border-color: var(--text-muted);
        }

        .header-btn svg {
            width: 20px;
            height: 20px;
            fill: var(--text-secondary);
        }

        .header-btn .badge {
            position: absolute;
            top: -4px;
            right: -4px;
            min-width: 18px;
            height: 18px;
            background: var(--error);
            color: white;
            font-size: 10px;
            font-weight: 700;
            border-radius: 9px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 4px;
        }

        .header-btn .badge:empty,
        .header-btn .badge[data-count="0"] {
            display: none;
        }

        .theme-toggle .sun { display: none; }
        [data-theme="dark"] .theme-toggle .sun { display: block; }
        [data-theme="dark"] .theme-toggle .moon { display: none; }

        /* Notification Dropdown */
        .notification-wrapper {
            position: relative;
        }

        .notification-dropdown {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            width: 400px;
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-xl);
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: var(--transition);
            z-index: 1000;
            overflow: hidden;
        }

        .notification-dropdown.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .notification-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 20px;
            border-bottom: 1px solid var(--border);
            background: var(--bg-secondary);
        }

        .notification-header h4 {
            font-size: 14px;
            font-weight: 700;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .notification-header h4 .count {
            background: var(--error);
            color: white;
            font-size: 10px;
            font-weight: 700;
            padding: 2px 8px;
            border-radius: 10px;
        }

        .notification-header-actions {
            display: flex;
            gap: 8px;
        }

        .notification-header-btn {
            padding: 6px 12px;
            background: transparent;
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            font-size: 11px;
            font-weight: 600;
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition);
        }

        .notification-header-btn:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .notification-header-btn.danger:hover {
            background: var(--error-light);
            color: var(--error);
            border-color: var(--error);
        }

        .notification-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .notification-item {
            display: flex;
            gap: 12px;
            padding: 14px 20px;
            border-bottom: 1px solid var(--border);
            cursor: pointer;
            transition: var(--transition);
        }

        .notification-item:hover {
            background: var(--bg-secondary);
        }

        .notification-item.unread {
            background: var(--primary-light);
            border-left: 3px solid var(--primary);
        }

        .notification-item.unread:hover {
            background: rgba(0, 82, 204, 0.12);
        }

        .notification-item:last-child {
            border-bottom: none;
        }

        .notification-icon {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .notification-icon svg {
            width: 20px;
            height: 20px;
            fill: white;
        }

        .notification-icon.success { background: linear-gradient(135deg, #00875A, #006644); }
        .notification-icon.warning { background: linear-gradient(135deg, #FF991F, #FF8B00); }
        .notification-icon.info { background: linear-gradient(135deg, #0052CC, #0747A6); }
        .notification-icon.error { background: linear-gradient(135deg, #DE350B, #BF2600); }

        .notification-content {
            flex: 1;
            min-width: 0;
        }

        .notification-title {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .notification-message {
            font-size: 12px;
            color: var(--text-muted);
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .notification-time {
            font-size: 10px;
            color: var(--text-muted);
            margin-top: 6px;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .notification-time svg {
            width: 12px;
            height: 12px;
            fill: var(--text-muted);
        }

        .notification-empty {
            padding: 40px 20px;
            text-align: center;
        }

        .notification-empty-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--bg-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 16px;
        }

        .notification-empty-icon svg {
            width: 30px;
            height: 30px;
            fill: var(--text-muted);
        }

        .notification-empty h5 {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .notification-empty p {
            font-size: 12px;
            color: var(--text-muted);
        }

        /* Main Content Area */
        .main-content {
            padding: 24px 32px;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Quick Stats */
        .quick-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }

        .quick-stat-card {
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 16px;
            transition: var(--transition);
        }

        .quick-stat-card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .quick-stat-icon {
            width: 48px;
            height: 48px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .quick-stat-icon svg {
            width: 24px;
            height: 24px;
            fill: white;
        }

        .quick-stat-icon.blue { background: linear-gradient(135deg, #0052CC, #0747A6); }
        .quick-stat-icon.green { background: linear-gradient(135deg, #00875A, #006644); }
        .quick-stat-icon.orange { background: linear-gradient(135deg, #FF991F, #FF8B00); }
        .quick-stat-icon.purple { background: linear-gradient(135deg, #6554C0, #5243AA); }

        .quick-stat-content h4 {
            font-size: 22px;
            font-weight: 800;
            color: var(--text-primary);
        }

        .quick-stat-content p {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 2px;
        }

        /* Form Container */
        .form-container {
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: var(--radius-xl);
            overflow: hidden;
            animation: fadeIn 0.4s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-header {
            background: linear-gradient(135deg, #0052CC 0%, #0747A6 100%);
            padding: 24px 32px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .form-header-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .form-header-icon {
            width: 52px;
            height: 52px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .form-header-icon svg {
            width: 26px;
            height: 26px;
            fill: white;
        }

        .form-header h2 {
            font-size: 20px;
            font-weight: 700;
            color: white;
        }

        .form-header p {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.7);
            margin-top: 4px;
        }

        .form-header-badge {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .form-header-badge svg {
            width: 16px;
            height: 16px;
            fill: white;
        }

        .form-body {
            padding: 32px;
        }

        /* Form Sections */
        .form-section {
            margin-bottom: 32px;
        }

        .form-section:last-child {
            margin-bottom: 0;
        }

        .form-section-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 2px solid var(--border);
        }

        .form-section-icon {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .form-section-icon svg {
            width: 20px;
            height: 20px;
            fill: white;
        }

        .form-section-icon.blue { background: linear-gradient(135deg, #0052CC, #0747A6); }
        .form-section-icon.green { background: linear-gradient(135deg, #00875A, #006644); }
        .form-section-icon.purple { background: linear-gradient(135deg, #6554C0, #5243AA); }
        .form-section-icon.orange { background: linear-gradient(135deg, #FF991F, #FF8B00); }

        .form-section-title h3 {
            font-size: 16px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .form-section-title p {
            font-size: 13px;
            color: var(--text-muted);
            margin-top: 2px;
        }

        /* Form Grid */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 24px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-label {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .form-label .required {
            color: var(--error);
            font-weight: 700;
        }

        .form-label .optional {
            font-size: 11px;
            font-weight: 400;
            color: var(--text-muted);
        }

        /* Input Styles */
        .input-wrapper {
            position: relative;
        }

        .input-icon {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 20px;
            fill: var(--text-muted);
            pointer-events: none;
            transition: var(--transition);
        }

        .input-wrapper.has-icon input,
        .input-wrapper.has-icon select {
            padding-left: 48px;
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            height: 52px;
            padding: 0 16px;
            background: var(--bg-primary);
            border: 2px solid var(--border);
            border-radius: var(--radius-md);
            font-family: inherit;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
            transition: var(--transition);
            outline: none;
        }

        .form-textarea {
            height: auto;
            min-height: 100px;
            padding: 16px;
            resize: vertical;
        }

        .form-input::placeholder,
        .form-textarea::placeholder {
            color: var(--text-muted);
            font-weight: 400;
        }

        .form-input:hover,
        .form-select:hover,
        .form-textarea:hover {
            border-color: var(--text-muted);
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 4px var(--primary-light);
        }

        .input-wrapper:focus-within .input-icon {
            fill: var(--primary);
        }

        .form-input.error {
            border-color: var(--error);
            box-shadow: 0 0 0 4px var(--error-light);
        }

        .form-input.success {
            border-color: var(--success);
            box-shadow: 0 0 0 4px var(--success-light);
        }

        /* Date Input */
        .date-input-wrapper {
            position: relative;
        }

        .date-input-wrapper .form-input {
            padding-right: 48px;
            cursor: pointer;
        }

        .date-input-wrapper input[type="date"]::-webkit-calendar-picker-indicator {
            position: absolute;
            right: 0;
            top: 0;
            width: 48px;
            height: 100%;
            opacity: 0;
            cursor: pointer;
        }

        .date-icon {
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 20px;
            fill: var(--text-muted);
            pointer-events: none;
            transition: var(--transition);
        }

        .date-input-wrapper:focus-within .date-icon {
            fill: var(--primary);
        }

        /* Select Styles */
        .form-select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%2397A0AF'%3E%3Cpath d='M7 10l5 5 5-5z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 24px;
            padding-right: 44px;
            cursor: pointer;
        }

        /* Amount Input */
        .amount-input-wrapper {
            position: relative;
        }

        .amount-prefix {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 16px;
            font-weight: 700;
            color: var(--text-muted);
            transition: var(--transition);
        }

        .amount-input-wrapper .form-input {
            padding-left: 60px;
            font-size: 18px;
            font-weight: 700;
        }

        .amount-input-wrapper:focus-within .amount-prefix {
            color: var(--primary);
        }

        /* Amount in Words Display */
        .amount-words-display {
            background: linear-gradient(135deg, var(--primary-light) 0%, var(--accent-light) 100%);
            border: 2px solid var(--primary);
            border-radius: var(--radius-md);
            padding: 16px 20px;
            min-height: 52px;
            display: flex;
            align-items: center;
        }

        .amount-words-display .label {
            font-size: 11px;
            font-weight: 600;
            color: var(--primary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-right: 12px;
            flex-shrink: 0;
        }

        .amount-words-display .words {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            text-transform: capitalize;
        }

        .amount-words-display .placeholder {
            font-size: 14px;
            font-weight: 400;
            color: var(--text-muted);
            font-style: italic;
        }

        /* Input Help Text */
        .input-help {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 6px;
        }

        .input-help svg {
            width: 14px;
            height: 14px;
            fill: currentColor;
            flex-shrink: 0;
        }

        .input-help.highlight {
            color: var(--primary);
            background: var(--primary-light);
            padding: 8px 12px;
            border-radius: var(--radius-sm);
            margin-top: 8px;
        }

        /* Transfer Info Box */
        .transfer-info-box {
            background: linear-gradient(135deg, var(--success-light) 0%, rgba(0, 135, 90, 0.05) 100%);
            border: 2px dashed var(--success);
            border-radius: var(--radius-md);
            padding: 16px 20px;
            margin-top: 24px;
        }

        .transfer-info-box .transfer-label {
            font-size: 11px;
            font-weight: 700;
            color: var(--success);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .transfer-info-box .transfer-label svg {
            width: 16px;
            height: 16px;
            fill: var(--success);
        }

        .transfer-info-box .transfer-flow {
            display: flex;
            align-items: center;
            gap: 16px;
            flex-wrap: wrap;
        }

        .transfer-info-box .transfer-party {
            flex: 1;
            min-width: 200px;
            background: var(--bg-primary);
            padding: 12px 16px;
            border-radius: var(--radius-sm);
            border: 1px solid var(--border);
        }

        .transfer-info-box .transfer-party-label {
            font-size: 10px;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .transfer-info-box .transfer-party-name {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-top: 4px;
        }

        .transfer-info-box .transfer-arrow {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background: var(--success);
            border-radius: 50%;
            flex-shrink: 0;
        }

        .transfer-info-box .transfer-arrow svg {
            width: 20px;
            height: 20px;
            fill: white;
        }

        /* Form Actions */
        .form-footer {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 24px 32px;
            background: var(--bg-secondary);
            border-top: 1px solid var(--border);
        }

        .form-footer-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .form-footer-right {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            height: 48px;
            padding: 0 24px;
            border-radius: var(--radius-md);
            font-family: inherit;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            border: 2px solid transparent;
            text-decoration: none;
        }

        .btn svg {
            width: 18px;
            height: 18px;
            fill: currentColor;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-hover);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 82, 204, 0.4);
        }

        .btn-secondary {
            background: var(--bg-primary);
            border-color: var(--border);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background: var(--bg-secondary);
            border-color: var(--text-muted);
        }

        .btn-success {
            background: linear-gradient(135deg, #00875A 0%, #006644 100%);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 135, 90, 0.4);
        }

        .btn-ghost {
            background: transparent;
            color: var(--text-secondary);
        }

        .btn-ghost:hover {
            background: var(--bg-secondary);
            color: var(--text-primary);
        }

        .btn-lg {
            height: 56px;
            padding: 0 32px;
            font-size: 16px;
            border-radius: var(--radius-lg);
        }

        .btn-excel {
            background: linear-gradient(135deg, #217346 0%, #185C37 100%);
            color: white;
        }

        .btn-excel:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(33, 115, 70, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, #DE350B 0%, #BF2600 100%);
            color: white;
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(222, 53, 11, 0.4);
        }

        /* Recent Entries Table */
        .recent-entries {
            margin-top: 24px;
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: var(--radius-xl);
            overflow: hidden;
        }

        .recent-entries-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px 24px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
        }

        .recent-entries-header h3 {
            font-size: 16px;
            font-weight: 700;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .recent-entries-header h3 .count {
            background: var(--primary-light);
            color: var(--primary);
            font-size: 12px;
            font-weight: 700;
            padding: 4px 10px;
            border-radius: 12px;
        }

        .table-wrapper {
            overflow-x: auto;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th,
        .data-table td {
            padding: 14px 16px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        .data-table th {
            background: var(--bg-secondary);
            font-size: 11px;
            font-weight: 700;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            white-space: nowrap;
        }

        .data-table td {
            font-size: 13px;
            color: var(--text-primary);
        }

        .data-table tbody tr:hover {
            background: var(--bg-secondary);
        }

        .data-table tbody tr:last-child td {
            border-bottom: none;
        }

        .table-cheque-no {
            font-weight: 600;
            color: var(--primary);
        }

        .table-amount {
            font-weight: 700;
            color: var(--success);
        }

        .table-date {
            color: var(--text-secondary);
            font-size: 12px;
        }

        .table-party {
            max-width: 150px;
        }

        .table-party-name {
            font-weight: 500;
            color: var(--text-primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .table-party-label {
            font-size: 10px;
            color: var(--text-muted);
            text-transform: uppercase;
        }

        .table-status {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
        }

        .table-status.pending {
            background: var(--warning-light);
            color: var(--warning);
        }

        .table-status.cleared {
            background: var(--success-light);
            color: var(--success);
        }

        .table-status.processing {
            background: var(--primary-light);
            color: var(--primary);
        }

        .table-status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: currentColor;
        }

        .table-actions {
            display: flex;
            gap: 8px;
        }

        .table-action-btn {
            width: 32px;
            height: 32px;
            border-radius: var(--radius-sm);
            border: 1px solid var(--border);
            background: var(--bg-primary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .table-action-btn:hover {
            background: var(--bg-secondary);
            border-color: var(--text-muted);
        }

        .table-action-btn svg {
            width: 16px;
            height: 16px;
            fill: var(--text-muted);
        }

        .table-action-btn:hover svg {
            fill: var(--text-primary);
        }

        .table-action-btn.edit:hover {
            border-color: var(--primary);
            background: var(--primary-light);
        }

        .table-action-btn.edit:hover svg {
            fill: var(--primary);
        }

        .table-action-btn.delete:hover {
            border-color: var(--error);
            background: var(--error-light);
        }

        .table-action-btn.delete:hover svg {
            fill: var(--error);
        }

        /* Footer */
        .footer {
            padding: 20px 32px;
            border-top: 1px solid var(--border);
            text-align: center;
        }

        .footer p {
            font-size: 12px;
            color: var(--text-muted);
        }

        /* Toast Notification */
        .toast-container {
            position: fixed;
            top: 24px;
            right: 24px;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .toast {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 16px 20px;
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-xl);
            min-width: 380px;
            max-width: 450px;
            animation: slideInRight 0.3s ease-out;
        }

        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(100px); }
            to { opacity: 1; transform: translateX(0); }
        }

        @keyframes slideOutRight {
            from { opacity: 1; transform: translateX(0); }
            to { opacity: 0; transform: translateX(100px); }
        }

        .toast.success { border-left: 4px solid var(--success); }
        .toast.error { border-left: 4px solid var(--error); }
        .toast.warning { border-left: 4px solid var(--warning); }
        .toast.info { border-left: 4px solid var(--info); }

        .toast-icon {
            width: 44px;
            height: 44px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .toast-icon svg {
            width: 22px;
            height: 22px;
            fill: white;
        }

        .toast.success .toast-icon { background: linear-gradient(135deg, #00875A, #006644); }
        .toast.error .toast-icon { background: linear-gradient(135deg, #DE350B, #BF2600); }
        .toast.warning .toast-icon { background: linear-gradient(135deg, #FF991F, #FF8B00); }
        .toast.info .toast-icon { background: linear-gradient(135deg, #0052CC, #0747A6); }

        .toast-content { flex: 1; }

        .toast-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .toast-message {
            font-size: 12px;
            color: var(--text-muted);
            line-height: 1.5;
        }

        .toast-details {
            margin-top: 8px;
            padding: 10px 12px;
            background: var(--bg-secondary);
            border-radius: var(--radius-sm);
            font-size: 11px;
        }

        .toast-details-row {
            display: flex;
            justify-content: space-between;
            padding: 3px 0;
        }

        .toast-details-label { color: var(--text-muted); }
        .toast-details-value { color: var(--text-primary); font-weight: 600; }

        .toast-close {
            width: 28px;
            height: 28px;
            border-radius: var(--radius-sm);
            border: none;
            background: transparent;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            flex-shrink: 0;
        }

        .toast-close:hover { background: var(--bg-secondary); }
        .toast-close svg { width: 16px; height: 16px; fill: var(--text-muted); }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: var(--bg-primary);
            border-radius: var(--radius-xl);
            padding: 32px;
            max-width: 400px;
            width: 90%;
            transform: scale(0.9);
            transition: var(--transition);
        }

        .modal-overlay.active .modal {
            transform: scale(1);
        }

        .modal-icon {
            width: 64px;
            height: 64px;
            border-radius: 50%;
            background: var(--error-light);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
        }

        .modal-icon svg {
            width: 32px;
            height: 32px;
            fill: var(--error);
        }

        .modal-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-primary);
            text-align: center;
            margin-bottom: 8px;
        }

        .modal-message {
            font-size: 14px;
            color: var(--text-secondary);
            text-align: center;
            margin-bottom: 24px;
        }

        .modal-actions {
            display: flex;
            gap: 12px;
        }

        .modal-actions .btn {
            flex: 1;
        }

        /* Edit Mode Banner */
        .edit-mode-banner {
            background: linear-gradient(135deg, var(--warning-light), rgba(255, 153, 31, 0.2));
            border: 2px solid var(--warning);
            border-radius: var(--radius-md);
            padding: 12px 20px;
            margin-bottom: 24px;
            display: none;
            align-items: center;
            gap: 12px;
        }

        .edit-mode-banner.active { display: flex; }

        .edit-mode-banner svg {
            width: 24px;
            height: 24px;
            fill: var(--warning);
        }

        .edit-mode-banner-content { flex: 1; }

        .edit-mode-banner-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .edit-mode-banner-subtitle {
            font-size: 12px;
            color: var(--text-muted);
        }

        .edit-mode-banner .btn {
            height: 36px;
            padding: 0 16px;
            font-size: 12px;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .quick-stats { grid-template-columns: repeat(2, 1fr); }
        }

        @media (max-width: 1024px) {
            .sidebar { transform: translateX(-100%); }
            .main-wrapper { margin-left: 0; }
        }

        @media (max-width: 768px) {
            .header { padding: 12px 16px; }
            .header-datetime { display: none; }
            .main-content { padding: 16px; }
            .form-grid { grid-template-columns: 1fr; }
            .quick-stats { grid-template-columns: 1fr; }
            .form-footer { flex-direction: column; gap: 16px; }
            .form-footer-left, .form-footer-right { width: 100%; justify-content: center; }
            .btn { flex: 1; }
            .form-header { flex-direction: column; gap: 16px; text-align: center; }
            .form-header-left { flex-direction: column; }
            .toast { min-width: 300px; max-width: 350px; }
            .notification-dropdown { width: 320px; right: -100px; }
            .transfer-info-box .transfer-flow { flex-direction: column; }
            .transfer-info-box .transfer-arrow { transform: rotate(90deg); }
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-shapes">
            <div class="sidebar-circle sidebar-circle-1"></div>
            <div class="sidebar-circle sidebar-circle-2"></div>
            <div class="sidebar-circle sidebar-circle-3"></div>
        </div>

        <div class="sidebar-logo">
            <div class="logo-icon">
                <svg viewBox="0 0 24 24">
                    <path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/>
                </svg>
            </div>
            <div class="logo-text">
                <span>ChequeTracker</span>
                <span>Management</span>
            </div>
        </div>

        <nav class="sidebar-nav">
            <div class="nav-section">
                <div class="nav-section-title">Main Menu</div>
                <a href="{% url 'dashboard' %}" class="nav-item">
                    <svg viewBox="0 0 24 24"><path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/></svg>
                    Dashboard
                </a>
                <a href="{% url 'cheque' %}" class="nav-item active">
                    <svg viewBox="0 0 24 24"><path d="M19 14V6c0-1.1-.9-2-2-2H3c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zm-9-1c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm13-6v11c0 1.1-.9 2-2 2H4v-2h17V7h2z"/></svg>
                    Cheque In
                    <span class="badge alert" id="pendingBadge">0</span>
                </a>
                <a href="{% url 'deposit' %}" class="nav-item">
                    <svg viewBox="0 0 24 24"><path d="M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4z"/></svg>
                    Deposit
                </a>
                <a href="{% url 'report' %}" class="nav-item">
                    <svg viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/></svg>
                    Reports
                </a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Settings</div>
                <a href="{% url 'setting' %}" class="nav-item">
                    <svg viewBox="0 0 24 24"><path d="M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg>
                    Settings
                </a>
                <a href="{% url 'help' %}" class="nav-item">
                    <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>
                    Help & Support
                </a>
            </div>
        </nav>

        <div class="sidebar-footer">
            <div class="sidebar-user">
                <div class="sidebar-user-avatar">
                    <svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
                </div>
                <div class="sidebar-user-info">
                    <div class="sidebar-user-name">John Doe</div>
                    <div class="sidebar-user-role">Administrator</div>
                </div>
            </div>
            <a href="#" class="logout-btn">
                <svg viewBox="0 0 24 24"><path d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"/></svg>
                Sign Out
            </a>
        </div>
    </aside>

    <!-- Main Wrapper -->
    <div class="main-wrapper">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <h1 class="header-title">Cheque In</h1>
                <p class="header-subtitle">Submit and process new cheques for verification</p>
            </div>
            <div class="header-right">
                <div class="header-datetime">
                    <div class="header-time" id="currentTime">00:00</div>
                    <div class="header-date" id="currentDate">Loading...</div>
                </div>
                <div class="header-actions">
                    <!-- Notification Button with Dropdown -->
                    <div class="notification-wrapper">
                        <button class="header-btn" id="notificationBtn" title="Notifications" onclick="toggleNotificationDropdown()">
                            <svg viewBox="0 0 24 24"><path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"/></svg>
                            <span class="badge" id="notificationBadge">0</span>
                        </button>
                        
                        <!-- Notification Dropdown -->
                        <div class="notification-dropdown" id="notificationDropdown">
                            <div class="notification-header">
                                <h4>
                                    Notifications
                                    <span class="count" id="notificationCount">0</span>
                                </h4>
                                <div class="notification-header-actions">
                                    <button class="notification-header-btn" onclick="markAllAsRead()">Mark all read</button>
                                    <button class="notification-header-btn danger" onclick="clearAllNotifications()">Clear all</button>
                                </div>
                            </div>
                            <div class="notification-list" id="notificationList">
                                <!-- Notifications will be loaded here -->
                            </div>
                        </div>
                    </div>

                    <button class="header-btn theme-toggle" onclick="toggleTheme()" title="Toggle Theme">
                        <svg class="moon" viewBox="0 0 24 24"><path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"/></svg>
                        <svg class="sun" viewBox="0 0 24 24"><path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0 .39-.39.39-1.03 0-1.41l-1.06-1.06zm1.06-10.96c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"/></svg>
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Quick Stats -->
            <div class="quick-stats">
                <div class="quick-stat-card">
                    <div class="quick-stat-icon blue">
                        <svg viewBox="0 0 24 24"><path d="M19 14V6c0-1.1-.9-2-2-2H3c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zm-9-1c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm13-6v11c0 1.1-.9 2-2 2H4v-2h17V7h2z"/></svg>
                    </div>
                    <div class="quick-stat-content">
                        <h4 id="todayCheques">0</h4>
                        <p>Today's Cheques</p>
                    </div>
                </div>
                <div class="quick-stat-card">
                    <div class="quick-stat-icon green">
                        <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
                    </div>
                    <div class="quick-stat-content">
                        <h4 id="clearedCheques">0</h4>
                        <p>Cleared</p>
                    </div>
                </div>
                <div class="quick-stat-card">
                    <div class="quick-stat-icon orange">
                        <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>
                    </div>
                    <div class="quick-stat-content">
                        <h4 id="pendingCheques">0</h4>
                        <p>Pending</p>
                    </div>
                </div>
                <div class="quick-stat-card">
                    <div class="quick-stat-icon purple">
                        <svg viewBox="0 0 24 24"><path d="M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4z"/></svg>
                    </div>
                    <div class="quick-stat-content">
                        <h4 id="totalAmount">NPR 0</h4>
                        <p>Total Amount</p>
                    </div>
                </div>
            </div>

            <!-- Form Container -->
            <div class="form-container">
                <div class="form-header">
                    <div class="form-header-left">
                        <div class="form-header-icon">
                            <svg viewBox="0 0 24 24"><path d="M19 14V6c0-1.1-.9-2-2-2H3c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zm-9-1c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm13-6v11c0 1.1-.9 2-2 2H4v-2h17V7h2z"/></svg>
                        </div>
                        <div>
                            <h2 id="formTitle">New Cheque Entry</h2>
                            <p id="formSubtitle">Fill in the cheque details below to submit</p>
                        </div>
                    </div>
                    <div class="form-header-badge">
                        <svg viewBox="0 0 24 24"><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/></svg>
                        <span id="formTime">--:--</span>
                    </div>
                </div>

                <form id="chequeForm" class="form-body" method="POST">
                    {% csrf_token %}
                    <!-- Edit Mode Banner -->
                    <div class="edit-mode-banner" id="editModeBanner">
                        <svg viewBox="0 0 24 24"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>
                        <div class="edit-mode-banner-content">
                            <div class="edit-mode-banner-title">Editing Cheque #<span id="editingChequeNo"></span></div>
                            <div class="edit-mode-banner-subtitle">Make changes and click Update to save</div>
                        </div>
                        <button type="button" class="btn btn-secondary" onclick="cancelEdit()">Cancel Edit</button>
                    </div>

                    <!-- Cheque Details Section -->
                    <div class="form-section">
                        <div class="form-section-header">
                            <div class="form-section-icon blue">
                                <svg viewBox="0 0 24 24"><path d="M19 14V6c0-1.1-.9-2-2-2H3c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zm-9-1c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3z"/></svg>
                            </div>
                            <div class="form-section-title">
                                <h3>Cheque Details</h3>
                                <p>Enter the information from the cheque</p>
                            </div>
                        </div>

                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">Cheque Number <span class="required">*</span></label>
                                <div class="input-wrapper has-icon">
                                    <input type="text" class="form-input" id="chequeNo" placeholder="e.g., 000123456" name="cheque_no" required>
                                    <svg class="input-icon" viewBox="0 0 24 24"><path d="M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z"/></svg>
                                </div>
                                <span class="input-help">
                                    <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>
                                    The cheque number printed at the bottom
                                </span>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Cheque Date <span class="required">*</span></label>
                                <div class="date-input-wrapper">
                                    <input type="date" class="form-input" id="chequeDate" name="cheque_date" required>
                                    <svg class="date-icon" viewBox="0 0 24 24"><path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM9 10H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm-8 4H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2z"/></svg>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Cheque Bank <span class="required">*</span></label>
                                <div class="input-wrapper has-icon">
                                    <select class="form-select" id="chequeBank" name="cheque_bank" required>
                                        <option value="">Select cheque bank</option>
                                        <optgroup label="Class A - Commercial Banks">
                                            <option value="Nabil Bank">Nabil Bank Limited</option>
                                            <option value="Nepal Investment Mega Bank">Nepal Investment Mega Bank Limited</option>
                                            <option value="Standard Chartered Bank">Standard Chartered Bank Nepal Limited</option>
                                            <option value="Himalayan Bank">Himalayan Bank Limited</option>
                                            <option value="Nepal SBI Bank">Nepal SBI Bank Limited</option>
                                            <option value="Nepal Bank">Nepal Bank Limited</option>
                                            <option value="Rastriya Banijya Bank">Rastriya Banijya Bank Limited</option>
                                            <option value="Everest Bank">Everest Bank Limited</option>
                                            <option value="NIC Asia Bank">NIC Asia Bank Limited</option>
                                            <option value="Global IME Bank">Global IME Bank Limited</option>
                                            <option value="Sanima Bank">Sanima Bank Limited</option>
                                            <option value="Prabhu Bank">Prabhu Bank Limited</option>
                                            <option value="NMB Bank">NMB Bank Limited</option>
                                        </optgroup>
                                        <option value="Other">Other Bank</option>
                                    </select>
                                    <svg class="input-icon" viewBox="0 0 24 24"><path d="M4 10h3v7H4zm6 0h3v7h-3zm-8 9h19v3H2zm14-9h3v7h-3zm-4.5-9L2 6v2h19V6z"/></svg>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Drawer / Issued By <span class="required">*</span></label>
                                <div class="input-wrapper has-icon">
                                    <input type="text" class="form-input" id="accountName" placeholder="Who wrote/issued the cheque" name="account_name" required>
                                    <svg class="input-icon" viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
                                </div>
                                <span class="input-help">
                                    <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>
                                    The person/company who wrote this cheque (money goes FROM)
                                </span>
                            </div>
                        </div>
                    </div>

                    <!-- Payee / Beneficiary Section -->
                    <div class="form-section">
                        <div class="form-section-header">
                            <div class="form-section-icon orange">
                                <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/></svg>
                            </div>
                            <div class="form-section-title">
                                <h3>Payee / Beneficiary</h3>
                                <p>Who is receiving the money from this cheque</p>
                            </div>
                        </div>

                        <div class="form-grid">
                            <div class="form-group full-width">
                                <label class="form-label">Payee Name / Pay To <span class="required">*</span></label>
                                <div class="input-wrapper has-icon">
                                    <input type="text" class="form-input" id="payeeName" placeholder="e.g., Pioneer Software Pvt. Ltd." name="payee_name" required>
                                    <svg class="input-icon" viewBox="0 0 24 24"><path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/></svg>
                                </div>
                                <span class="input-help highlight">
                                    <svg viewBox="0 0 24 24"><path d="M11 17h2v-6h-2v6zm1-15C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zM11 9h2V7h-2v2z"/></svg>
                                    Your company name or the person receiving the payment (money goes TO)
                                </span>
                            </div>
                        </div>

                        <!-- Transfer Flow Visualization -->
                        <div class="transfer-info-box" id="transferInfoBox" style="display: none;">
                            <div class="transfer-label">
                                <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
                                Transaction Flow Preview
                            </div>
                            <div class="transfer-flow">
                                <div class="transfer-party">
                                    <div class="transfer-party-label">From (Drawer)</div>
                                    <div class="transfer-party-name" id="previewDrawer">-</div>
                                </div>
                                <div class="transfer-arrow">
                                    <svg viewBox="0 0 24 24"><path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"/></svg>
                                </div>
                                <div class="transfer-party">
                                    <div class="transfer-party-label">To (Payee)</div>
                                    <div class="transfer-party-name" id="previewPayee">-</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Amount Section -->
                    <div class="form-section">
                        <div class="form-section-header">
                            <div class="form-section-icon green">
                                <svg viewBox="0 0 24 24"><path d="M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4z"/></svg>
                            </div>
                            <div class="form-section-title">
                                <h3>Cheque Amount</h3>
                                <p>Enter the amount and it will be converted to words automatically</p>
                            </div>
                        </div>

                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">Amount in Figures <span class="required">*</span></label>
                                <div class="amount-input-wrapper">
                                    <span class="amount-prefix">NPR</span>
                                    <input type="number" class="form-input" id="chequeAmount" placeholder="0.00" step="0.01" min="0" name="cheque_amount" required oninput="convertAmountToWords()">
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Amount in Words <span class="optional">(Auto-generated)</span></label>
                                <div class="amount-words-display">
                                    <span class="label">Words:</span>
                                    <span class="placeholder" id="amountWordsText">Enter amount to see in words</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Additional Information -->
                    <div class="form-section">
                        <div class="form-section-header">
                            <div class="form-section-icon purple">
                                <svg viewBox="0 0 24 24"><path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 9h12v2H6V9zm8 5H6v-2h8v2zm4-6H6V6h12v2z"/></svg>
                            </div>
                            <div class="form-section-title">
                                <h3>Additional Information</h3>
                                <p>Any notes or remarks for this cheque</p>
                            </div>
                        </div>

                        <div class="form-grid">
                            <div class="form-group full-width">
                                <label class="form-label">Remarks / Notes <span class="optional">(Optional)</span></label>
                                <textarea class="form-textarea" id="remarks" placeholder="Enter any additional notes... (e.g., payment for invoice #123, project name, etc.)" name="remarks"></textarea>
                            </div>
                        </div>
                    </div>
                </form>

                <div class="form-footer">
                    <div class="form-footer-left">
                        <button type="button" class="btn btn-ghost" onclick="resetForm()">
                            <svg viewBox="0 0 24 24"><path d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"/></svg>
                            Reset Form
                        </button>
                    </div>
                    <div class="form-footer-right">
                        <button type="submit" class="btn btn-success btn-lg" id="submitBtn" onclick="submitCheque(event)">
                            <svg viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
                            <span id="submitBtnText">Submit Cheque</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Recent Entries -->
            <div class="recent-entries">
                <div class="recent-entries-header">
                    <h3>
                        Recent Entries
                        <span class="count" id="entriesCount">0</span>
                    </h3>
                    <button class="btn btn-excel" onclick="exportToExcel()">
                        <svg viewBox="0 0 24 24" width="18" height="18">
                            <path fill="currentColor" d="M21.17 3.25Q21.5 3.25 21.76 3.5 22 3.74 22 4.08V19.92Q22 20.26 21.76 20.5 21.5 20.75 21.17 20.75H7.83Q7.5 20.75 7.24 20.5 7 20.26 7 19.92V17H2.83Q2.5 17 2.24 16.76 2 16.5 2 16.17V7.83Q2 7.5 2.24 7.24 2.5 7 2.83 7H7V4.08Q7 3.74 7.24 3.5 7.5 3.25 7.83 3.25M7 13.06L8.18 15.28H9.97L8 12.06L9.93 8.89H8.22L7.13 10.9L7.09 10.96L7.06 11.03Q6.8 10.5 6.5 9.96 6.25 9.43 5.97 8.89H4.16L6.05 12.08L4 15.28H5.78M13.88 19.5V17H8.25V19.5M13.88 15.75V12.63H12V15.75M13.88 11.38V8.25H12V11.38M13.88 7V4.5H8.25V7M20.75 19.5V17H15.13V19.5M20.75 15.75V12.63H15.13V15.75M20.75 11.38V8.25H15.13V11.38M20.75 7V4.5H15.13V7Z"/>
                        </svg>
                        Export to Excel
                    </button>
                </div>
                <div class="table-wrapper">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Cheque No.</th>
                                <th>From (Drawer)</th>
                                <th>To (Payee)</th>
                                <th>Bank</th>
                                <th>Amount</th>
                                <th>Cheque Date</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="entriesTableBody">
                            <!-- Entries will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <!-- Delete Confirmation Modal -->
    <div class="modal-overlay" id="deleteModal">
        <div class="modal">
            <div class="modal-icon">
                <svg viewBox="0 0 24 24"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
            </div>
            <div class="modal-title">Delete Cheque Entry?</div>
            <div class="modal-message">Are you sure you want to delete cheque #<span id="deleteChequeName"></span>? This action cannot be undone.</div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeDeleteModal()">Cancel</button>
                <button class="btn btn-danger" onclick="confirmDelete()">Delete</button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <script>
        // Constants
        const STORAGE_KEY = 'chequeTrackerData';
        const NOTIFICATIONS_KEY = 'chequeTrackerNotifications';

        // State
        let chequeEntries = [];
        let notifications = [];
        let editingIndex = null;
        let deleteIndex = null;

        // ==================== NOTIFICATION SYSTEM ====================
        
        function loadNotifications() {
            const saved = localStorage.getItem(NOTIFICATIONS_KEY);
            if (saved) {
                notifications = JSON.parse(saved);
            }
            renderNotifications();
            updateNotificationBadge();
        }

        function saveNotifications() {
            localStorage.setItem(NOTIFICATIONS_KEY, JSON.stringify(notifications));
        }

        function addNotification(data) {
            const notification = {
                id: Date.now() + Math.random().toString(36).substr(2, 9),
                type: data.type || 'general',
                category: data.category || 'info',
                title: data.title,
                message: data.message,
                read: false,
                timestamp: new Date().toISOString()
            };
            
            notifications.unshift(notification);
            
            if (notifications.length > 50) {
                notifications = notifications.slice(0, 50);
            }
            
            saveNotifications();
            renderNotifications();
            updateNotificationBadge();
            
            return notification;
        }

        function renderNotifications() {
            const container = document.getElementById('notificationList');
            const unreadCount = notifications.filter(n => !n.read).length;
            
            document.getElementById('notificationCount').textContent = unreadCount;
            
            if (notifications.length === 0) {
                container.innerHTML = `
                    <div class="notification-empty">
                        <div class="notification-empty-icon">
                            <svg viewBox="0 0 24 24"><path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"/></svg>
                        </div>
                        <h5>No Notifications</h5>
                        <p>You're all caught up!</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = notifications.slice(0, 10).map(notification => `
                <div class="notification-item ${notification.read ? '' : 'unread'}" onclick="markAsRead('${notification.id}')">
                    <div class="notification-icon ${notification.category}">
                        ${getNotificationIcon(notification.category)}
                    </div>
                    <div class="notification-content">
                        <div class="notification-title">${notification.title}</div>
                        <div class="notification-message">${notification.message}</div>
                        <div class="notification-time">
                            <svg viewBox="0 0 24 24"><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/></svg>
                            ${getTimeAgo(notification.timestamp)}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function getNotificationIcon(category) {
            const icons = {
                success: '<svg viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>',
                warning: '<svg viewBox="0 0 24 24"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>',
                info: '<svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>',
                error: '<svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>'
            };
            return icons[category] || icons.info;
        }

        function getTimeAgo(timestamp) {
            const now = new Date();
            const then = new Date(timestamp);
            const diffMs = now - then;
            const diffMins = Math.floor(diffMs / 60000);
            const diffHours = Math.floor(diffMs / 3600000);
            const diffDays = Math.floor(diffMs / 86400000);
            
            if (diffMins < 1) return 'Just now';
            if (diffMins < 60) return `${diffMins} min${diffMins > 1 ? 's' : ''} ago`;
            if (diffHours < 24) return `${diffHours} hour${diffHours > 1 ? 's' : ''} ago`;
            if (diffDays < 7) return `${diffDays} day${diffDays > 1 ? 's' : ''} ago`;
            return then.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
        }

        function updateNotificationBadge() {
            const unreadCount = notifications.filter(n => !n.read).length;
            const badge = document.getElementById('notificationBadge');
            badge.textContent = unreadCount > 9 ? '9+' : unreadCount;
            badge.setAttribute('data-count', unreadCount);
        }

        function toggleNotificationDropdown() {
            const dropdown = document.getElementById('notificationDropdown');
            dropdown.classList.toggle('active');
        }

        function markAsRead(id) {
            const notification = notifications.find(n => n.id === id);
            if (notification) {
                notification.read = true;
                saveNotifications();
                renderNotifications();
                updateNotificationBadge();
            }
        }

        function markAllAsRead() {
            notifications.forEach(n => n.read = true);
            saveNotifications();
            renderNotifications();
            updateNotificationBadge();
            showToast('success', 'All Read', 'All notifications marked as read');
        }

        function clearAllNotifications() {
            notifications = [];
            saveNotifications();
            renderNotifications();
            updateNotificationBadge();
            showToast('success', 'Cleared', 'All notifications have been cleared');
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
            const wrapper = document.querySelector('.notification-wrapper');
            const dropdown = document.getElementById('notificationDropdown');
            
            if (wrapper && !wrapper.contains(e.target)) {
                dropdown.classList.remove('active');
            }
        });

        // ==================== NUMBER TO WORDS ====================
        
        const ones = ['', 'One', 'Two', 'Three', 'Four', 'Five', 'Six', 'Seven', 'Eight', 'Nine', 'Ten',
                      'Eleven', 'Twelve', 'Thirteen', 'Fourteen', 'Fifteen', 'Sixteen', 'Seventeen', 
                      'Eighteen', 'Nineteen'];
        const tens = ['', '', 'Twenty', 'Thirty', 'Forty', 'Fifty', 'Sixty', 'Seventy', 'Eighty', 'Ninety'];

        function numberToWords(num) {
            if (num === 0) return 'Zero';
            if (num < 0) return 'Negative ' + numberToWords(Math.abs(num));

            let words = '';

            if (Math.floor(num / 10000000) > 0) {
                words += numberToWords(Math.floor(num / 10000000)) + ' Crore ';
                num %= 10000000;
            }

            if (Math.floor(num / 100000) > 0) {
                words += numberToWords(Math.floor(num / 100000)) + ' Lakh ';
                num %= 100000;
            }

            if (Math.floor(num / 1000) > 0) {
                words += numberToWords(Math.floor(num / 1000)) + ' Thousand ';
                num %= 1000;
            }

            if (Math.floor(num / 100) > 0) {
                words += ones[Math.floor(num / 100)] + ' Hundred ';
                num %= 100;
            }

            if (num > 0) {
                if (num < 20) {
                    words += ones[num];
                } else {
                    words += tens[Math.floor(num / 10)];
                    if (num % 10 > 0) {
                        words += ' ' + ones[num % 10];
                    }
                }
            }

            return words.trim();
        }

        function convertAmountToWords() {
            const amountInput = document.getElementById('chequeAmount');
            const wordsDisplay = document.getElementById('amountWordsText');
            const amount = parseFloat(amountInput.value);

            if (isNaN(amount) || amount <= 0) {
                wordsDisplay.textContent = 'Enter amount to see in words';
                wordsDisplay.className = 'placeholder';
                return;
            }

            const rupees = Math.floor(amount);
            const paisa = Math.round((amount - rupees) * 100);

            let words = 'Rupees ' + numberToWords(rupees);

            if (paisa > 0) {
                words += ' and ' + numberToWords(paisa) + ' Paisa';
            }

            words += ' Only';

            wordsDisplay.textContent = words;
            wordsDisplay.className = 'words';
        }

        function formatNepaliNumber(num) {
            const numStr = Math.floor(num).toString();
            let result = '';
            let count = 0;
            
            for (let i = numStr.length - 1; i >= 0; i--) {
                count++;
                result = numStr[i] + result;
                
                if (count === 3 && i !== 0) {
                    result = ',' + result;
                } else if (count > 3 && (count - 3) % 2 === 0 && i !== 0) {
                    result = ',' + result;
                }
            }
            
            return result;
        }

        function formatDate(dateStr) {
            const date = new Date(dateStr);
            return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
        }

        // ==================== TRANSFER PREVIEW ====================

        function updateTransferPreview() {
            const drawer = document.getElementById('accountName').value.trim();
            const payee = document.getElementById('payeeName').value.trim();
            const previewBox = document.getElementById('transferInfoBox');
            
            if (drawer || payee) {
                previewBox.style.display = 'block';
                document.getElementById('previewDrawer').textContent = drawer || '-';
                document.getElementById('previewPayee').textContent = payee || '-';
            } else {
                previewBox.style.display = 'none';
            }
        }

        // ==================== DATA MANAGEMENT ====================

        function loadData() {
            const saved = localStorage.getItem(STORAGE_KEY);
            if (saved) {
                chequeEntries = JSON.parse(saved);
            }
            renderTable();
            updateStats();
            loadNotifications();
        }

        function saveData() {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(chequeEntries));
            updateStats();
        }

        function updateStats() {
            const today = new Date().toDateString();
            let todayCheques = 0;
            let clearedCheques = 0;
            let pendingCheques = 0;
            let totalAmount = 0;

            chequeEntries.forEach(entry => {
                if (new Date(entry.submittedAt).toDateString() === today) {
                    todayCheques++;
                }
                if (entry.status === 'cleared') clearedCheques++;
                if (entry.status === 'pending') pendingCheques++;
                totalAmount += parseFloat(entry.amount) || 0;
            });

            document.getElementById('todayCheques').textContent = todayCheques;
            document.getElementById('clearedCheques').textContent = clearedCheques;
            document.getElementById('pendingCheques').textContent = pendingCheques;
            document.getElementById('totalAmount').textContent = 'NPR ' + formatNepaliNumber(totalAmount);
            document.getElementById('entriesCount').textContent = chequeEntries.length;
            document.getElementById('pendingBadge').textContent = pendingCheques;
        }

        // ==================== TABLE RENDERING ====================

        function renderTable() {
            const tbody = document.getElementById('entriesTableBody');
            
            if (chequeEntries.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="8" style="text-align: center; padding: 40px; color: var(--text-muted);">
                            No cheque entries yet. Submit your first cheque above.
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = chequeEntries.map((entry, index) => `
                <tr data-index="${index}">
                    <td class="table-cheque-no">${entry.chequeNo}</td>
                    <td class="table-party">
                        <div class="table-party-label">Drawer</div>
                        <div class="table-party-name" title="${entry.accountName}">${entry.accountName}</div>
                    </td>
                    <td class="table-party">
                        <div class="table-party-label">Payee</div>
                        <div class="table-party-name" title="${entry.payeeName || '-'}">${entry.payeeName || '-'}</div>
                    </td>
                    <td>${entry.chequeBank}</td>
                    <td class="table-amount">NPR ${formatNepaliNumber(entry.amount)}</td>
                    <td class="table-date">${formatDate(entry.chequeDate)}</td>
                    <td>
                        <span class="table-status ${entry.status}">
                            <span class="table-status-dot"></span>
                            ${entry.status.charAt(0).toUpperCase() + entry.status.slice(1)}
                        </span>
                    </td>
                    <td>
                        <div class="table-actions">
                            <button class="table-action-btn edit" title="Edit" onclick="editEntry(${index})">
                                <svg viewBox="0 0 24 24"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>
                            </button>
                            <button class="table-action-btn delete" title="Delete" onclick="showDeleteModal(${index})">
                                <svg viewBox="0 0 24 24"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        // ==================== FORM OPERATIONS ====================

        function setDefaultDates() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('chequeDate').value = today;
        }

        function submitCheque(e) {
            e.preventDefault();

            const form = document.getElementById('chequeForm');
            const requiredFields = form.querySelectorAll('[required]');
            let isValid = true;

            requiredFields.forEach(field => {
                if (!field.value.trim()) {
                    field.classList.add('error');
                    isValid = false;
                } else {
                    field.classList.remove('error');
                    field.classList.add('success');
                }
            });

            if (!isValid) {
                showToast('error', 'Validation Error', 'Please fill in all required fields');
                return;
            }

            const formData = {
                chequeNo: document.getElementById('chequeNo').value,
                chequeDate: document.getElementById('chequeDate').value,
                chequeBank: document.getElementById('chequeBank').value,
                accountName: document.getElementById('accountName').value,
                payeeName: document.getElementById('payeeName').value,
                amount: parseFloat(document.getElementById('chequeAmount').value),
                amountInWords: document.getElementById('amountWordsText').textContent,
                remarks: document.getElementById('remarks').value,
                status: 'pending',
                submittedAt: new Date().toISOString()
            };

            if (editingIndex !== null) {
                formData.submittedAt = chequeEntries[editingIndex].submittedAt;
                chequeEntries[editingIndex] = formData;
                
                showToast('success', 'Cheque Updated!', `Cheque #${formData.chequeNo} has been updated successfully`, formData);
                
                addNotification({
                    type: 'cheque-update',
                    category: 'info',
                    title: 'Cheque Updated',
                    message: `Cheque #${formData.chequeNo} for NPR ${formatNepaliNumber(formData.amount)} has been updated.`
                });
                
                cancelEdit();
            } else {
                chequeEntries.unshift(formData);
                
                showToast('success', 'Cheque Submitted!', `Cheque #${formData.chequeNo} has been submitted successfully`, formData);
                
                addNotification({
                    type: 'cheque-submit',
                    category: 'success',
                    title: 'New Cheque Added',
                    message: `Cheque #${formData.chequeNo} for NPR ${formatNepaliNumber(formData.amount)} from ${formData.accountName} to ${formData.payeeName} has been added.`
                });
            }

            saveData();
            renderTable();
            resetForm();
        }

        function resetForm() {
            document.getElementById('chequeForm').reset();
            document.querySelectorAll('.form-input, .form-select, .form-textarea').forEach(field => {
                field.classList.remove('error', 'success');
            });
            document.getElementById('amountWordsText').textContent = 'Enter amount to see in words';
            document.getElementById('amountWordsText').className = 'placeholder';
            document.getElementById('transferInfoBox').style.display = 'none';
            setDefaultDates();
            
            if (editingIndex !== null) {
                cancelEdit();
            }
        }

        // ==================== EDIT FUNCTIONS ====================

        function editEntry(index) {
            const entry = chequeEntries[index];
            editingIndex = index;

            document.getElementById('chequeNo').value = entry.chequeNo;
            document.getElementById('chequeDate').value = entry.chequeDate;
            document.getElementById('chequeBank').value = entry.chequeBank;
            document.getElementById('accountName').value = entry.accountName;
            document.getElementById('payeeName').value = entry.payeeName || '';
            document.getElementById('chequeAmount').value = entry.amount;
            document.getElementById('remarks').value = entry.remarks || '';
            
            convertAmountToWords();
            updateTransferPreview();

            document.getElementById('editModeBanner').classList.add('active');
            document.getElementById('editingChequeNo').textContent = entry.chequeNo;
            document.getElementById('formTitle').textContent = 'Edit Cheque Entry';
            document.getElementById('formSubtitle').textContent = 'Update the cheque details below';
            document.getElementById('submitBtnText').textContent = 'Update Cheque';

            document.querySelector('.form-container').scrollIntoView({ behavior: 'smooth' });

            showToast('warning', 'Edit Mode', `Now editing cheque #${entry.chequeNo}. Make changes and click Update.`);
        }

        function cancelEdit() {
            editingIndex = null;
            document.getElementById('editModeBanner').classList.remove('active');
            document.getElementById('formTitle').textContent = 'New Cheque Entry';
            document.getElementById('formSubtitle').textContent = 'Fill in the cheque details below to submit';
            document.getElementById('submitBtnText').textContent = 'Submit Cheque';
            resetForm();
        }

        // ==================== DELETE FUNCTIONS ====================

        function showDeleteModal(index) {
            deleteIndex = index;
            const entry = chequeEntries[index];
            document.getElementById('deleteChequeName').textContent = entry.chequeNo;
            document.getElementById('deleteModal').classList.add('active');
        }

        function closeDeleteModal() {
            deleteIndex = null;
            document.getElementById('deleteModal').classList.remove('active');
        }

        function confirmDelete() {
            if (deleteIndex !== null) {
                const entry = chequeEntries[deleteIndex];
                chequeEntries.splice(deleteIndex, 1);
                saveData();
                renderTable();
                
                showToast('success', 'Cheque Deleted', `Cheque #${entry.chequeNo} has been deleted successfully`);
                
                addNotification({
                    type: 'cheque-delete',
                    category: 'warning',
                    title: 'Cheque Deleted',
                    message: `Cheque #${entry.chequeNo} for NPR ${formatNepaliNumber(entry.amount)} has been deleted.`
                });
                
                closeDeleteModal();
            }
        }

        // ==================== TOAST NOTIFICATION ====================

        function showToast(type, title, message, data = null) {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            let detailsHtml = '';
            if (data && type === 'success') {
                detailsHtml = `
                    <div class="toast-details">
                        <div class="toast-details-row">
                            <span class="toast-details-label">Cheque No:</span>
                            <span class="toast-details-value">${data.chequeNo}</span>
                        </div>
                        <div class="toast-details-row">
                            <span class="toast-details-label">From:</span>
                            <span class="toast-details-value">${data.accountName}</span>
                        </div>
                        <div class="toast-details-row">
                            <span class="toast-details-label">To:</span>
                            <span class="toast-details-value">${data.payeeName || '-'}</span>
                        </div>
                        <div class="toast-details-row">
                            <span class="toast-details-label">Amount:</span>
                            <span class="toast-details-value">NPR ${formatNepaliNumber(data.amount)}</span>
                        </div>
                    </div>
                `;
            }
            
            const iconSvg = type === 'success' 
                ? '<svg viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>'
                : type === 'warning'
                ? '<svg viewBox="0 0 24 24"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>'
                : type === 'info'
                ? '<svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>'
                : '<svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>';
            
            toast.innerHTML = `
                <div class="toast-icon">${iconSvg}</div>
                <div class="toast-content">
                    <div class="toast-title">${title}</div>
                    <div class="toast-message">${message}</div>
                    ${detailsHtml}
                </div>
                <button class="toast-close" onclick="this.parentElement.remove()">
                    <svg viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                </button>
            `;

            container.appendChild(toast);

            setTimeout(() => {
                toast.style.animation = 'slideOutRight 0.3s ease-out forwards';
                setTimeout(() => toast.remove(), 300);
            }, 5000);
        }

        // ==================== EXPORT TO EXCEL ====================

        function exportToExcel() {
            if (chequeEntries.length === 0) {
                showToast('error', 'No Data', 'There are no entries to export');
                return;
            }

            const excelData = chequeEntries.map((entry, index) => ({
                'S.N.': index + 1,
                'Cheque Number': entry.chequeNo,
                'Drawer (From)': entry.accountName,
                'Payee (To)': entry.payeeName || '',
                'Cheque Bank': entry.chequeBank,
                'Amount (NPR)': entry.amount,
                'Amount in Words': entry.amountInWords || '',
                'Cheque Date': formatDate(entry.chequeDate),
                'Status': entry.status.charAt(0).toUpperCase() + entry.status.slice(1),
                'Remarks': entry.remarks || '',
                'Submitted Date': formatDate(entry.submittedAt)
            }));

            const totalAmount = chequeEntries.reduce((sum, entry) => sum + (parseFloat(entry.amount) || 0), 0);
            
            excelData.push({});
            excelData.push({
                'S.N.': '',
                'Cheque Number': 'TOTAL',
                'Drawer (From)': `${chequeEntries.length} Cheques`,
                'Payee (To)': '',
                'Cheque Bank': '',
                'Amount (NPR)': totalAmount,
                'Amount in Words': '',
                'Cheque Date': '',
                'Status': '',
                'Remarks': '',
                'Submitted Date': ''
            });

            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.json_to_sheet(excelData);

            ws['!cols'] = [
                { wch: 6 }, { wch: 18 }, { wch: 25 }, { wch: 25 },
                { wch: 20 }, { wch: 15 }, { wch: 40 },
                { wch: 15 }, { wch: 12 }, { wch: 30 }, { wch: 18 }
            ];

            XLSX.utils.book_append_sheet(wb, ws, 'Cheque Records');

            const today = new Date();
            const dateStr = today.toISOString().split('T')[0];
            const filename = `Cheque_Records_${dateStr}.xlsx`;

            XLSX.writeFile(wb, filename);

            showToast('success', 'Excel Export Successful!', `${chequeEntries.length} entries exported to ${filename}`);
            
            addNotification({
                type: 'export-success',
                category: 'success',
                title: 'Export Completed',
                message: `Cheque records (${chequeEntries.length} entries) exported to Excel successfully.`
            });
        }

        // ==================== THEME TOGGLE ====================

        function toggleTheme() {
            const body = document.body;
            const currentTheme = body.getAttribute('data-theme');
            body.setAttribute('data-theme', currentTheme === 'dark' ? '' : 'dark');
            localStorage.setItem('theme', currentTheme === 'dark' ? 'light' : 'dark');
        }

        // ==================== TIME UPDATE ====================

        function updateTime() {
            const now = new Date();
            const timeOptions = { hour: '2-digit', minute: '2-digit', hour12: true };
            const dateOptions = { weekday: 'short', month: 'short', day: 'numeric' };
            
            document.getElementById('currentTime').textContent = now.toLocaleTimeString('en-US', timeOptions);
            document.getElementById('currentDate').textContent = now.toLocaleDateString('en-US', dateOptions);
            document.getElementById('formTime').textContent = now.toLocaleTimeString('en-US', timeOptions);
        }

        // ==================== INITIALIZE ====================

        window.addEventListener('load', () => {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.body.setAttribute('data-theme', 'dark');
            }

            loadData();
            setDefaultDates();
            updateTime();
            setInterval(updateTime, 1000);

            // Add input listeners for transfer preview
            document.getElementById('accountName').addEventListener('input', updateTransferPreview);
            document.getElementById('payeeName').addEventListener('input', updateTransferPreview);

            document.querySelectorAll('.form-input, .form-select, .form-textarea').forEach(field => {
                field.addEventListener('blur', function() {
                    if (this.hasAttribute('required')) {
                        if (this.value.trim()) {
                            this.classList.remove('error');
                            this.classList.add('success');
                        }
                    }
                });

                field.addEventListener('focus', function() {
                    this.classList.remove('error');
                });
            });
        });

        document.getElementById('deleteModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeDeleteModal();
            }
        });

        document.addEventListener('keydown', function(e) {
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                submitCheque(e);
            }
            if (e.key === 'Escape') {
                closeDeleteModal();
                document.getElementById('notificationDropdown').classList.remove('active');
                if (editingIndex !== null) {
                    cancelEdit();
                }
            }
        });
    </script>
</body>
</html>